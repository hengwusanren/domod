{"version":3,"file":"Kernel.js","sources":["../src/Util.js","../src/OArray.js","../src/Kernel.js"],"sourcesContent":["var gid = (function () {\n    var n = 0;\n    return function () {\n        return n++;\n    };\n})();\n\nvar isBoolean = function (v) {\n    return typeof v === 'boolean';\n};\n\nvar isNumber = function (v) {\n    return typeof v === 'number';\n};\n\nvar isNumeric = function (v) {\n    var n = parseInt(v);\n    if (isNaN(n)) return false;\n    return (typeof v === 'number' || typeof v === 'string') && n == v;\n};\n\nvar isString = function (v) {\n    return typeof v === 'string';\n};\n\nvar isFunction = function (v) {\n    return typeof v === 'function';\n};\n\nvar isObject = function (v) {\n    return v != null && !(v instanceof Array) && Object.prototype.toString.call(v) === '[object Object]';\n};\n\nvar isArray = function (v) {\n    return Object.prototype.toString.call(v) === '[object Array]';\n};\n\nvar isLikeArray = function (v) {\n    return v instanceof Array;\n};\n\nvar isBasic = function (v) {\n    return v == null\n        || typeof v === 'boolean'\n        || typeof v === 'number'\n        || typeof v === 'string'\n        || typeof v === 'function';\n};\n\nvar isInstance = function (v, creator) {\n    return typeof creator === 'function' && v instanceof creator;\n};\n\nvar isDirectInstance = function (v, creator) {\n    return v.constructor === creator;\n};\n\nvar isNode = function (v) {\n    if (typeof Node !== 'function') return false;\n    return v instanceof Node;\n};\n\nvar isNamedNodeMap = function (v) {\n    return v instanceof NamedNodeMap;\n};\n\nvar isEventName = function (v) {\n    if (!isString(v) || !v.startsWith('on')) return false;\n    return v.substr(2); // TODO\n};\n\nvar isCSSSelector = function (v) {\n    return v.indexOf(' ') > 0 || v.indexOf('.') >= 0\n        || v.indexOf('[') >= 0 || v.indexOf('#') >= 0;\n};\n\nvar each = function (v, func, arrayReverse) {\n    var i;\n    var len;\n    if (!isArray(v) && isFunction(v.forEach)) {\n        v.forEach(func);\n    } else if (isObject(v)) {\n        for (var p in v) {\n            if (!v.hasOwnProperty(p)) continue;\n            if (func(v[p], p) === false) break;\n        }\n    } else if (isLikeArray(v)) {\n        if (!arrayReverse) {\n            for (i = 0, len = v.length; i < len; i++) {\n                if (func(v[i], i) === false) break;\n            }\n        } else {\n            for (i = v.length - 1; i >= 0; i--) {\n                if (func(v[i], i) === false) break;\n            }\n        }\n    } else if (isNode(v)) {\n        var ret = false;\n        switch (v.nodeType) {\n        case Node.ELEMENT_NODE:\n            break;\n        case Node.TEXT_NODE:\n        case Node.COMMENT_NODE:\n        case Node.PROCESSING_INSTRUCTION_NODE:\n        case Node.DOCUMENT_NODE:\n        case Node.DOCUMENT_TYPE_NODE:\n        case Node.DOCUMENT_FRAGMENT_NODE:\n        default:\n            ret = true;\n        }\n        if (ret) return;\n        var childNodes = v.childNodes;\n        for (i = 0, len = childNodes.length; i < len; i++) {\n            func(childNodes[i]);\n            each(childNodes[i], func);\n        }\n    } else if (isNamedNodeMap(v)) {\n        for (i = 0, len = v.length; i < len; i++) {\n            if (func(v[i]['nodeValue'], v[i]['nodeName']) === false) break;\n        }\n    }\n};\n\nvar eachIndexOf = function (str, pat) {\n    var p0 = 0;\n    var p1;\n    var len = str.length;\n    var r = [];\n    while (p0 < len) {\n        p1 = str.indexOf(pat, p0);\n        if (p1 < len) {\n            r.push(p1);\n            p0 = p1 + pat.length;\n        }\n    }\n    return r;\n};\n\nvar eachUnique = function (arr, func) {\n    if (!isLikeArray(arr)) return;\n    var map = {};\n    for (var i = 0, len = arr.length; i < len; i++) {\n        var vi = arr[i];\n        if (!isNumber(vi) || !isString(vi) || map[vi]) continue;\n        map[vi] = true;\n        var r = func(vi);\n        if (r === false) break;\n    }\n};\n\nvar unique = function (arr) {\n    var r = [];\n    eachUnique(arr, function (v) {\n        r.push(v);\n    });\n    return r;\n};\n\nvar clone = function (val) {\n    var r = val;\n    if (isObject(val)) {\n        r = {};\n        each(val, function (v, p) {\n            r[p] = clone(v);\n        });\n    } else if (isLikeArray(val)) {\n        r = new val.constructor();\n        each(val, function (v) {\n            r.push(clone(v));\n        });\n    }\n    return r;\n};\n\nvar hasProperty = function (val, p) {\n    if (isObject(val)) {\n        return val.hasOwnProperty(p);\n    } else if (isLikeArray(val)) {\n        var n = parseInt(p);\n        return isNumeric(p) && val.length > n && n >= 0;\n    }\n    return false;\n};\n\nvar clear = function (val, p, withBasicVal) {\n    var inRef = isString(p) || isNumber(p);\n    var target = inRef ? val[p] : val;\n\n    if (isObject(target) || isLikeArray(target)) {\n        each(target, function (v, p) {\n            clear(target, p);\n        });\n        if (isLikeArray(target)) {\n            shrinkArray(target);\n        }\n    }\n\n    if (inRef) {\n        val[p] = withBasicVal;\n    }\n};\n\nvar shrinkArray = function (arr, len) {\n    var limited = isNumber(len);\n    if (!limited) {\n        each(arr, function (v, i) {\n            if (v == null) arr.pop();\n        }, true);\n    } else {\n        each(arr, function (v, i) {\n            if (i >= len) arr.pop();\n            else return false;\n        }, true);\n        while (arr.length < len) {\n            arr.push(null);\n        }\n    }\n    return arr;\n};\n\nvar touchLeaves = function (obj) {\n    each(obj, function (v, p) {\n        if (isBasic(v)) {\n            obj[p] = v;\n        } else {\n            touchLeaves(v);\n        }\n    });\n};\n\nvar extend = function (dest, srcs, clean, handler) {\n    if (!isObject(dest)) return srcs;\n    var args;\n    var argOffset = 0;\n    handler = undefined;\n    clean = false;\n    var lastArg = arguments[arguments.length - 1];\n    if (isFunction(lastArg)) {\n        argOffset = 2;\n        handler = lastArg;\n        clean = !!arguments[arguments.length - 2];\n    } else if (lastArg === true) {\n        argOffset = 1;\n        clean = lastArg;\n    }\n    args = Array.prototype.slice.call(arguments, 1, arguments.length - argOffset);\n\n    function extendObj(obj, src, clean) {\n        if (!isObject(src) && !isLikeArray(src)) return src;\n        if (isLikeArray(src)) {\n            if (!isLikeArray(obj)) return clone(src);\n            else {\n                obj.splice.apply(obj, [0, obj.length].concat(src));\n                return obj;\n            }\n        }\n        each(src, function (v, p) {\n            if (!hasProperty(obj, p) || isBasic(v)) {\n                if (obj[p] !== v) {\n                    obj[p] = clone(v);\n                }\n            } else {\n                obj[p] = extendObj(obj[p], v, clean);\n            }\n        });\n        if (clean) {\n            each(obj, function (v, p) {\n                if (!hasProperty(src, p)) {\n                    clear(obj, p);\n                }\n            });\n        }\n        return obj;\n    }\n\n    each(args, function (src) {\n        dest = extendObj(dest, src, clean);\n    });\n    return dest;\n};\n\nvar allRefs = function (obj) {\n    if (isLikeArray(obj)) return [];\n    var refs = [];\n    each(obj, function (v, p) {\n        refs.push(p);\n        if (isObject(v)) {\n            var f = allRefs(v);\n            each(f, function (pp) {\n                refs.push(p + '.' + pp);\n            });\n        }\n    })\n    return refs;\n};\n\nvar hasRef = function (root, refPath) {\n    var v = root;\n    var paths = refPath.split('.');\n    while (paths.length) {\n        var p = paths.shift();\n        if (!hasProperty(v, p)) return false;\n        v = v[p];\n    }\n    return true;\n};\n\nvar seekTarget = function (refPath, root) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var v;\n    for (var i = 0, len = args.length; i < len; i++) {\n        v = args[i];\n        if (isArray(v)) {\n            var r = seekTarget.apply(null, [refPath].concat(v));\n            if (r) return r;\n        } else {\n            if (hasRef(v, refPath)) return v;\n        }\n    }\n};\n\nvar seekTargetIndex = function (refPath, roots) {\n    var index = roots.length - 1;\n    each(roots, function (v, i) {\n        if (hasRef(v, refPath)) {\n            index = i;\n            return false;\n        }\n    });\n    return index;\n};\n\nvar refData = function (root, refPath, value) {\n    var toSet = arguments.length >= 3;\n    var v = root;\n    var paths = [];\n    if (refPath) paths = refPath.split('.');\n\n    if (!toSet) {\n        while (paths.length) {\n            if (isBasic(v)) return undefined;\n            v = v[paths.shift()];\n        }\n        return v;\n    } else {\n        while (paths.length) {\n            if (isBasic(v)) return undefined;\n            if (paths.length === 1) {\n                v[paths.shift()] = value;\n            } else {\n                v = v[paths.shift()];\n            }\n        }\n        return value;\n    }\n};\n\nfunction addEvent($el, eventName, handler, useCapture) {\n    if ($el.addEventListener) {\n        $el.addEventListener(eventName, handler, !!useCapture);\n    } else {\n        if (eventName === 'input') {\n            eventName = 'propertychange';\n        }\n        $el.attachEvent('on' + eventName, handler);\n    }\n}\n\nfunction flatten(root, objectFilter, clean) {\n    objectFilter = objectFilter || function () { return true; };\n    var ext = {};\n    each(root, function (v, p) {\n        if (isObject(v) && !objectFilter(v)) {\n            var f = flatten(v, objectFilter, clean);\n            each(f, function (vv, pp) {\n                ext[p + '.' + pp] = vv;\n            });\n        } else {\n            if (objectFilter(v) || !clean) {\n                ext[p] = v;\n            }\n        }\n    })\n    return ext;\n}\n\nexport {\n    gid,\n    isBoolean,\n    isNumber,\n    isNumeric,\n    isString,\n    isFunction,\n    isObject,\n    isArray,\n    isLikeArray,\n    isBasic,\n    isInstance,\n    isDirectInstance,\n    isNode,\n    isNamedNodeMap,\n    isEventName,\n    isCSSSelector,\n    each,\n    eachIndexOf,\n    eachUnique,\n    unique,\n    clone,\n    hasProperty,\n    clear,\n    shrinkArray,\n    touchLeaves,\n    extend,\n    allRefs,\n    hasRef,\n    seekTarget,\n    seekTargetIndex,\n    refData,\n    addEvent,\n    flatten\n}\n","import * as Util from './Util'\n\nvar canUseProxy = typeof Proxy === 'function';\n\nfunction defineProperty(target, prop, desc) {\n    if (Object.defineProperty) {\n        Object.defineProperty(target, prop, desc);\n    } else {\n        if ('value' in desc) {\n            target[prop] = desc.value;\n        }\n    }\n}\n\nfunction OArray(arr, option) {\n    if (Util.isObject(arr) && arguments.length === 1) option = arr;\n    if (!Util.isArray(arr)) arr = [];\n    if (!option) option = {};\n\n    defineProperty(this, '__data', {\n        value: arr\n    });\n\n    defineProperty(this, 'length', {\n        get: function () {\n            return arr.length;\n        },\n        set: function (v) {\n            arr.length = v;\n        }\n    });\n\n    var _this = this;\n\n    var eventNames = ['set', 'push', 'pop', 'unshift', 'shift', 'splice', 'resize'];\n    eventNames.forEach(function (e) {\n        defineProperty(_this, 'on' + e, { value: [] });\n    });\n    eventNames.forEach(function (e) {\n        _this.addEventListener(e, option['on' + e]);\n    });\n\n    Util.each(arr, function (v, i) {\n        _this.assignElement(i);\n    });\n}\n\nOArray.prototype = [];\nOArray.prototype.constructor = OArray;\n\nOArray.prototype.addEventListener = function (eventName, handler) {\n    var _this = this;\n    if (Util.isObject(eventName)) {\n        Util.each(eventName, function (hdl, evt) {\n            _this.addEventListener(evt, hdl);\n        });\n        return;\n    }\n    if (!this['on' + eventName] || !Util.isFunction(handler)) return;\n    this['on' + eventName].push(handler);\n};\nOArray.prototype.on = OArray.prototype.addEventListener;\n\nOArray.prototype.removeEventListener = function (eventName, handler) {\n    var _this = this;\n    if (Util.isObject(eventName)) {\n        Util.each(eventName, function (hdl, evt) {\n            _this.removeEventListener(evt, hdl);\n        });\n        return;\n    }\n    if (!this['on' + eventName] || !Util.isFunction(handler)) return;\n    var handlers = this['on' + eventName];\n    Util.each(handlers, function (h, i) {\n        if (h === handler) {\n            handlers.splice(i, 1);\n            return false;\n        }\n    });\n};\nOArray.prototype.off = OArray.prototype.removeEventListener;\n\nOArray.prototype.dispatchEvent = function (eventName, args) {\n    args = Array.prototype.slice.call(arguments, 1);\n    var _this = this;\n    Util.each(this['on' + eventName], function (handler) {\n        handler.apply(_this, args);\n    });\n};\nOArray.prototype.trigger = OArray.prototype.dispatchEvent;\n\nOArray.prototype.get = function (i) {\n    return this.__data[i];\n};\n\nOArray.prototype.set = function (i, v) {\n    var e = this.__data[i];\n    if (Util.isBasic(e) || Util.isBasic(v)) {\n        this.dispatchEvent('set', e, v, i, this.__data);\n        this.__data[i] = v;\n    } else {\n        Util.extend(e, v, true);\n    }\n};\n\nOArray.prototype.assignElement = function (i) {\n    defineProperty(this, i, {\n        get: function () {\n            return this.get(i);\n        },\n        set: function (val) {\n            this.set(i, val);\n        },\n        configurable: true,\n        enumerable: true\n    });\n};\nOArray.prototype.deleteElement = function () {\n    if (this.hasOwnProperty(this.length - 1)) delete this[this.length - 1];\n};\n\n['push', 'unshift'].forEach(function (f) {\n    OArray.prototype[f] = function (v) {\n        this.__data[f](v);\n        this.assignElement(this.length - 1);\n        this.dispatchEvent(f, v);\n        this.dispatchEvent('resize');\n    };\n});\n['pop', 'shift'].forEach(function (f) {\n    OArray.prototype[f] = function () {\n        this.dispatchEvent(f, this.__data[f === 'pop' ? (this.length - 1) : 0]);\n        this.deleteElement();\n        this.__data[f]();\n        this.dispatchEvent('resize');\n    };\n});\n\nOArray.prototype.toArray = function (notClone) {\n    return notClone ? this.__data : Util.clone(this.__data);\n};\n\nOArray.prototype.splice = function (startIndex, howManyToDelete, itemToInsert) {\n    if (!Util.isNumber(startIndex) || startIndex < 0) startIndex = 0;\n    if (startIndex >= this.length) startIndex = this.length;\n    if (!Util.isNumber(howManyToDelete) || howManyToDelete < 0) howManyToDelete = 0;\n    if (howManyToDelete + startIndex > this.length) howManyToDelete = this.length - startIndex;\n\n    var itemsToDelete = [];\n    for (var i = startIndex; i < startIndex + howManyToDelete; i++) {\n        itemsToDelete.push(Util.clone(this.get(i)));\n    }\n\n    var itemsToInsert = Array.prototype.slice.call(arguments, 2);\n    var howManyToInsert = itemsToInsert.length;\n\n    var howManyToSet = Math.min(howManyToDelete, howManyToInsert);\n    for (var j = startIndex; j < startIndex + howManyToSet; j++) {\n        this.set(j, itemsToInsert[j - startIndex]);\n    }\n\n    if (howManyToDelete === howManyToInsert) return;\n\n    var args;\n    if (howManyToDelete > howManyToInsert) {\n        args = [startIndex + howManyToInsert, howManyToDelete - howManyToInsert];\n        Array.prototype.splice.apply(this.__data, args);\n    } else {\n        args = [startIndex + howManyToDelete, 0].concat(itemsToInsert.slice(howManyToDelete));\n        Array.prototype.splice.apply(this.__data, args);\n    }\n    this.dispatchEvent.apply(this, ['splice'].concat(args));\n    this.dispatchEvent('resize');\n};\n\nOArray.prototype.forEach = function (fn) {\n    for (var i = 0; i < this.length; i++) {\n        var r = fn(this.get(i), i);\n        if (r === false) break;\n    }\n};\n\n['reverse', 'sort'].forEach(function (f) {\n    OArray.prototype[f] = function () {\n        var r = Util.clone(this.__data);\n        Array.prototype[f].apply(r, arguments);\n        for (var i = 0; i < this.length; i++) {\n            this.set(i, r[i]);\n        }\n    };\n});\n\n['slice', 'concat', 'filter', 'map', 'reduce',\n    'indexOf', 'find', 'findIndex', 'fill', 'join'].forEach(function (f) {\n    OArray.prototype[f] = function () {\n        return Array.prototype[f].apply(this.toArray(), arguments);\n    };\n});\n\nOArray.prototype.clear = function () {\n    while (this.length) {\n        this.pop();\n    }\n    return this;\n};\n\nOArray.prototype.cast = function (arr) {\n    return this.splice.apply(this, [0, this.length].concat(arr));\n};\n\nexport default OArray\n","import * as Util from './Util'\nimport OArray from './OArray'\n\nvar Store = {};\nvar Dnstreams = {};\nvar ResultsIn = {};\nvar Upstreams = {};\nvar ResultsFrom = {};\nvar Laziness = {};\nvar PropKernelTable = {};\nvar KernelStatus = {};\nvar GetterSetter = {};\nvar __ = {};\n\nfunction defineProperty(target, prop, desc, proppath) {\n    if (!Util.isNode(target)) {\n        if (Util.isInstance(target, OArray)) {\n            if (desc.set) {\n                target.on('set', function (oval, nval, i, arr) {\n                    if (i == prop) {\n                        desc.set(nval);\n                    }\n                });\n            }\n        } else {\n            Object.defineProperty(target, prop, desc);\n        }\n    } else {\n        if ('value' in desc) {\n            target[prop] = desc.value;\n        }\n    }\n    proppath = proppath || fullpathOf(prop, target);\n    if (!GetterSetter[proppath] && ('get' in desc || 'set' in desc)) GetterSetter[proppath] = {};\n    if ('get' in desc) {\n        GetterSetter[proppath].get = desc.get;\n    }\n    if ('set' in desc) {\n        GetterSetter[proppath].set = desc.set;\n    }\n}\n\nfunction fullpathOf(ref, root) {\n    if (root === undefined) return ref;\n    var pre = register(root);\n    if (pre == null) return ref || '';\n    return pre + (ref ? ('.' + ref) : '');\n}\n\nfunction register(root) {\n    if (root === Store || (!Util.isObject(root) && !Util.isNode(root))) return null;\n    if (!root.__kernel_root) {\n        var id = 'kr_' + Util.gid();\n        defineProperty(root, '__kernel_root', {\n            value: id\n        });\n        Store[id] = root;\n    }\n    return root.__kernel_root;\n}\n\nfunction formatStream(stream, root) {\n    if (Util.isObject(stream) || Util.isString(stream)) stream = [stream];\n    if (Util.isArray(stream)) {\n        return stream.map(function (a) {\n            if (Util.isObject(a)) return register(a.root) + '.' + a.alias;\n            if (Util.isString(a)) return register(root) + '.' + a;\n            return null;\n        });\n    }\n    return [];\n}\n\nfunction propKernelOrder(proppath) {\n    if (PropKernelTable[proppath] === undefined) return 0;\n    return PropKernelTable[proppath].length;\n}\n\n/**\n * Kernel constructor function.\n * @constructor\n */\nfunction Kernel(root, path, relations) {\n    var obj = {};\n    var value;\n    obj = scopeOf(path, root);\n    if (obj == null) return;\n    value = obj.target[obj.property];\n\n    var proppath = register(root) + '.' + path;\n    var __kid = proppath + '#' + propKernelOrder(proppath);\n    defineProperty(this, '__kid', {\n        value: __kid\n    });\n    KernelStatus[this.__kid] = 1;\n    if (PropKernelTable[proppath] === undefined) {\n        PropKernelTable[proppath] = [];\n        if (Util.hasProperty(obj.target, obj.property) && !Util.isInstance(obj.target, OArray)) {\n            delete obj.target[obj.property];\n        }\n    }\n    PropKernelTable[proppath].push(1);\n\n    var dnstream = formatStream(relations.dnstream, root);\n    var resultIn = relations.resultIn;\n    var upstream = formatStream(relations.upstream, root);\n    var resultFrom = relations.resultFrom;\n    var lazy = !!relations.lazy;\n    if (!Dnstreams[proppath]) Dnstreams[proppath] = {};\n    dnstream.forEach(function (p) {\n        if (!Upstreams[p]) Upstreams[p] = {};\n        if (!Upstreams[p][proppath]) Upstreams[p][proppath] = {};\n        Upstreams[p][proppath][__kid] = 1;\n        if (!Dnstreams[proppath][p]) Dnstreams[proppath][p] = {};\n        Dnstreams[proppath][p][__kid] = 1;\n    });\n    if (!ResultsIn[proppath]) ResultsIn[proppath] = [];\n    ResultsIn[proppath].push(Util.isFunction(resultIn) ? resultIn : null);\n    if (!Upstreams[proppath]) Upstreams[proppath] = {};\n    upstream.forEach(function (p) {\n        if (!Upstreams[proppath][p]) Upstreams[proppath][p] = {};\n        Upstreams[proppath][p][__kid] = 1;\n        if (!Dnstreams[p]) Dnstreams[p] = {};\n        if (!Dnstreams[p][proppath]) Dnstreams[p][proppath] = {};\n        Dnstreams[p][proppath][__kid] = 1;\n    });\n    if (Util.isFunction(resultFrom)) {\n        ResultsFrom[proppath] = {\n            f: resultFrom,\n            k: this.__kid,\n            deps: upstream\n        };\n    }\n    if (lazy) Laziness[proppath] = true;\n\n    if (PropKernelTable[proppath].length === 1) {\n        defineProperty(obj.target, obj.property, {\n            get: function () {\n                if (ResultsFrom[proppath] && KernelStatus[ResultsFrom[proppath].k] !== 0) {\n                    var v = ResultsFrom[proppath].f.apply(\n                        null,\n                        ResultsFrom[proppath].deps.map(function (p) { return Data(null, p); })\n                    );\n                    if (value !== v) {\n                        GetterSetter[proppath].set(v);\n                    }\n                }\n                return value;\n            },\n            set: function (val, force) {\n                if (!force && val === value) return;\n                if (val !== value) {\n                    if (Util.isInstance(obj.target, OArray) &&\n                        !(Util.isObject(value) && Util.isObject(val))) {\n                        obj.target.set(obj.property, val);\n                        value = obj.target[obj.property];\n                    } else {\n                        value = Util.extend(value, val);\n                    }\n                }\n\n                ResultsIn[proppath] && ResultsIn[proppath].forEach(function (f, k) {\n                    f && (KernelStatus[proppath + '#' + k] !== 0) && f.apply(root, [value]);\n                });\n                if (Dnstreams[proppath]) {\n                    Util.each(Dnstreams[proppath], function (kmap, ds) {\n                        var toUpdateDnstream = false;\n                        Util.each(kmap, function (v, k) {\n                            if (KernelStatus[k] !== 0) {\n                                toUpdateDnstream = true;\n                                return false;\n                            }\n                        });\n                        toUpdateDnstream && ResultsFrom[ds] && !Laziness[ds] && Data(null, ds);\n                    });\n                }\n            },\n            // configurable: true,\n            enumerable: true\n        }, proppath);\n    }\n\n    if (Util.hasProperty(relations, 'value')) {\n        Data(null, proppath, relations.value);\n    }\n}\n\nKernel.prototype.disable = function () {\n    KernelStatus[this.__kid] = 0;\n};\nKernel.prototype.enable = function () {\n    KernelStatus[this.__kid] = 1;\n};\nKernel.prototype.destroy = function () {};\n\n/**\n * Whether an object is a relation definition.\n * @param {Object} obj \n * @return {Boolean}\n */\nfunction isRelationDefinition(obj) {\n    if (!Util.isObject(obj)) return false;\n    var r = true;\n    var specProps = {\n        __isRelation: 2, // !\n        dnstream: 1, // *\n        resultIn: 1, // *\n        upstream: 1, // *\n        resultFrom: 1, // *\n        lazy: true,\n        value: true\n    };\n    var count = 0;\n    Util.each(obj, function (v, p) {\n        if (specProps[p] === 2) {\n            r = true;\n            count++;\n            return false;\n        }\n        if (!specProps[p]) {\n            r = false;\n            return false;\n        }\n        if (specProps[p] === 1) {\n            count++;\n        }\n    });\n    return r && (count > 0);\n}\n\n/**\n * Define and bind data with relations in a whole (PropertyPath => Relation) map.\n * @param {Object} obj                  The data object. If `relations` is undefined, it contains relations.\n * @param {Object|Undefined} relations  A map from propertyPath to relation.\n */\nfunction Relate(obj, relations) {\n    var fr;\n    if (arguments.length === 1) {\n        if (!Util.isObject(obj)) return null;\n        fr = Util.flatten(obj, isRelationDefinition, true);\n    } else if (Util.isObject(relations)) {\n        fr = Util.flatten(relations, isRelationDefinition, true);\n    } else {\n        return null;\n    }\n    Util.each(fr, function (rel, p) {\n        new Kernel(obj, p, rel);\n    });\n\n    return obj;\n}\n\n/**\n * Get the target and property.\n * @param {String} ref \n * @param {Object} root \n */\nfunction scopeOf(ref, root) {\n    if (root === undefined) root = Store;\n    if ((!Util.isObject(root) && !Util.isNode(root)) || !Util.isString(ref)) return null;\n    var fullpath = fullpathOf(ref, root);\n    var lastDot = fullpath.lastIndexOf('.');\n    var targetPath = fullpath.substring(0, lastDot);\n    var propPath = fullpath.substring(lastDot + 1);\n    var targetValue = Data(null, targetPath, __, true);\n    if (targetValue == null) {\n        targetValue = Data(null, targetPath, {}, true);\n    }\n    return {\n        target: targetValue,\n        property: propPath\n    };\n}\n\nfunction assign(proppath, src, obj) {\n    obj = obj || Data(null, proppath);\n    Util.each(src, function (v, p) {\n        var pp = proppath + '.' + p;\n        if (!Util.hasProperty(obj, p) || Util.isBasic(obj[p]) || Util.isBasic(v)) {\n            Data(null, pp, Util.clone(v));\n        } else {\n            assign(pp, v, obj[p]);\n        }\n    });\n}\n\n/**\n * Get or set data, and trigger getters or setters.\n */\nfunction Data(root, refPath, value, ensurePathValid) {\n    root = root || Store;\n    var toSet = arguments.length >= 3 && value !== __;\n    var v = root;\n    var proppath = fullpathOf(null, root);\n    var paths = [];\n    if (refPath) paths = refPath.split('.');\n    var parent;\n    var prop;\n\n    while (paths.length) {\n        if (ensurePathValid && v == null) {\n            parent[prop] = {};\n        } else if (Util.isBasic(v)) {\n            return undefined;\n        }\n        prop = paths.shift();\n        proppath += (proppath === '' ? '' : '.') + prop;\n        if (toSet && paths.length === 0) { /* set */\n            if (Util.isInstance(v, OArray) &&\n                !(Util.isObject(v[prop]) && Util.isObject(value))) {\n                v.set(prop, value);\n            } else {\n                v[prop] = Util.extend(v[prop], value);\n            }\n        } else { /* get */\n            parent = v;\n            v = v[prop];\n        }\n    }\n    return toSet ? v[prop] : v;\n}\n\nexport { Kernel, Relate, Data }\n"],"names":["defineProperty","Util.isObject","Util.isArray","Util.each","Util.isFunction","Util.isBasic","Util.extend","Util.clone","Util.isNumber","Util.isNode","Util.isInstance","Util.gid","Util.isString","Util.hasProperty","Util.flatten"],"mappings":"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"}