!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.domod=e()}(this,function(){"use strict";function t(t,e,n,r){t.addEventListener?t.addEventListener(e,n,!!r):("input"===e&&(e="propertychange"),t.attachEvent("on"+e,n))}function e(t,n,r){n=n||function(){return!0};var o={};return F(t,function(t,i){if(M(t)&&!n(t)){var a=e(t,n,r);F(a,function(t,e){o[i+"."+e]=t})}else!n(t)&&r||(o[i]=t)}),o}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,n):"value"in n&&(t[e]=n.value)}function r(t,e){M(t)&&1===arguments.length&&(e=t),j(t)||(t=[]),e||(e={}),n(this,"__data",{value:t}),n(this,"length",{get:function(){return t.length},set:function(e){t.length=e}});var r=this,o=["set","push","pop","unshift","shift","splice","resize"];o.forEach(function(t){n(r,"on"+t,{value:[]})}),o.forEach(function(t){r.addEventListener(t,e["on"+t])}),F(t,function(t,e){r.assignElement(e)})}function o(t,e,n,o){x(t)?"value"in n&&(t[e]=n.value):L(t,r)?n.set&&t.on("set",function(t,r,o,i){o==e&&n.set(r)}):Object.defineProperty(t,e,n),!1!==o&&(o=o||u(e,t),!nt[o]&&("get"in n||"set"in n)&&(nt[o]={}),"get"in n&&(nt[o].get=n.get),"set"in n&&(nt[o].set=n.set))}function i(t,e){return e&&""!==e?t&&""!==t?t+"."+e:e:t}function a(t){return t.replace(/"([0-9a-zA-Z$_]+)"/gm,function(t,e){return e}).replace(/'([0-9a-zA-Z$_]+)'/gm,function(t,e){return e}).replace(/\[([0-9a-zA-Z$_]+)\]/gm,function(t,e){return"."+e}).split(".")}function u(t,e){if(void 0===e)return t;var n=s(e);return null==n?t||"":i(n,t)}function s(t){if(t===H||!M(t)&&!x(t))return null;if(!t.__kernel_root){var e="kr_"+b();o(t,"__kernel_root",{value:e}),H[e]=t}return t.__kernel_root}function c(t,e){return(M(t)||Z(t))&&(t=[t]),j(t)?t.map(function(t){return M(t)?i(s(t.root),t.alias):Z(t)?i(s(e),t):null}):[]}function f(t){return void 0===tt[t]?0:tt[t].length}function l(t,e,n){"string"==typeof e&&(e=a(e).join("."));var u,l={};if(null!=(l=d(e,t))){u=l.target[l.property];var p;l.target.__proppath?p=i(l.target.__proppath,l.property):(o(l.target,"__proppath",{value:i(s(t),a(e).slice(0,-1).join("."))}),p=i(s(t),e));var h=p+"#"+f(p);o(this,"__kid",{value:h},!1),et[this.__kid]=1,void 0===tt[p]&&(tt[p]=[],S(l.target,l.property)&&!L(l.target,r)&&delete l.target[l.property]),tt[p].push(1);var v=c(n.dnstream,t),y=n.resultIn,g=c(n.upstream,t),m=n.resultFrom,E=!!n.lazy;X[p]||(X[p]={}),v.forEach(function(t){Y[t]||(Y[t]={}),Y[t][p]||(Y[t][p]={}),Y[t][p][h]=1,X[p][t]||(X[p][t]={}),X[p][t][h]=1}),q[p]||(q[p]=[]),q[p].push(O(y)?y:null),Y[p]||(Y[p]={}),g.forEach(function(t){Y[p][t]||(Y[p][t]={}),Y[p][t][h]=1,X[t]||(X[t]={}),X[t][p]||(X[t][p]={}),X[t][p][h]=1}),O(m)&&(J[p]={f:m,k:this.__kid,deps:g}),E&&(Q[p]=!0),1===tt[p].length&&o(l.target,l.property,{get:function(){if(J[p]&&0!==et[J[p].k]){var t=J[p].f.apply(null,J[p].deps.map(function(t){return _(null,t)}));u!==t&&nt[p].set(t)}return u},set:function(e,n){(n||e!==u)&&(e!==u&&(!L(l.target,r)||M(u)&&M(e)?u=W(u,e):(l.target.set(l.property,e),u=l.target[l.property])),q[p]&&q[p].forEach(function(e,n){e&&0!==et[p+"#"+n]&&e.apply(t,[u])}),X[p]&&F(X[p],function(t,e){var n=!1;F(t,function(t,e){if(0!==et[e])return n=!0,!1}),n&&J[e]&&!Q[e]&&_(null,e)}))},enumerable:!0},p),S(n,"value")&&_(null,p,n.value)}}function p(t){if(!M(t))return!1;var e=!0,n={__isRelation:2,dnstream:1,resultIn:1,upstream:1,resultFrom:1,lazy:!0,value:!0},r=0;return F(t,function(t,o){return 2===n[o]?(e=!0,r++,!1):n[o]?void(1===n[o]&&r++):(e=!1,!1)}),e&&r>0}function h(t,n){var r;if(1===arguments.length){if(!M(t))return null;r=e(t,p,!0)}else{if(!M(n))return null;r=e(n,p,!0)}return F(r,function(e,n){new l(t,n,e)}),t}function d(t,e){if(void 0===e&&(e=H),!M(e)&&!x(e)||!Z(t))return null;var n=u(t,e),r=n.lastIndexOf("."),o=n.substring(0,r),i=n.substring(r+1),a=_(null,o,rt,!0);return null==a&&(a=_(null,o,{},!0)),{target:a,property:i}}function _(t,e,n,o){t=t||H;var i=arguments.length>=3&&n!==rt,u=t,s=[];e&&(s=a(e));for(var c,f;s.length;){if(o&&null==u)c[f]={};else if(T(u))return;f=s.shift(),i&&0===s.length?!L(u,r)||M(u[f])&&M(n)?u[f]=W(u[f],n):u.set(f,n):(c=u,u=u[f])}return i?u[f]:u}function v(t,e,n){ot.refBeginsWithDollar&&(t=t.replace(/(\$[a-zA-Z$_][0-9a-zA-Z$_]*)\s*=[^=]/g,function(t,e){return t.replace(e,"this."+e.substr(1))})),j(e)?n||(n=e[e.length-1]):(e=[e],n||(n=e[0]));var r={};F(e,function(t){F(t,function(t,e){e in r||(r[e]=t)})});var o=Object.keys(r);ot.refBeginsWithDollar&&(o=o.map(function(t){return"$"+t}));var i=Object.values(r);return new Function(o.join(","),"return ("+t+")").apply(n,i)}function y(t,e){t=g(t);var n=null;try{n=v(t,e)}catch(t){}return n}function g(t){var e=/{{([^{}]*)}}/g;return t.replace(e,function(t,e){return"' + ("+e+") + '"})}function m(t,e){var n=/{{([^{}]*)}}/g;return t.replace(n,function(t,n){var r=null;try{r=v(n,e)}catch(t){}return r})}function E(t){t=";"+t+";";var e,n=function(t){return t.replace(/\.([0-9]+)([^0-9a-zA-Z$_]?)/g,function(t,e,n){return"["+e+"]"+n})};return ot.refBeginsWithDollar?(t=t.replace(/([^a-zA-Z0-9$_.])this\./gm,function(t,e){return e+"$"}),e=/\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*/g,(t.match(e)||[]).map(function(t){return t.substr(1)}).map(n)):(t=t.replace(/([^a-zA-Z0-9$_.])this\./gm,function(t,e){return e}),e=/([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*/g,(t.match(e)||[]).map(n))}function A(t,e){var n,o,i,a;ot.refBeginsWithDollar?(a=at.each12.exec(t))?(n=a[1].substr(1),o=a[3].substr(1),i=a[5].substr(1)):(n=(a=at.each11.exec(t))[1].substr(1),i=a[3].substr(1)):(a=at.each22.exec(t))?(n=a[1],o=a[3],i=a[5]):(n=(a=at.each21.exec(t))[1],i=a[3]);var u=G(i,e),s=_(u,i);return s instanceof r||_(u,i,s=new r(s)),{target:s,targetRef:i,iterator:{val:n,key:o}}}function w(t){var e=/{{([^{}]*)}}/g,n=[];return t.replace(e,function(t,e){return n.push(e),""}),n}function D(t,e,n,r,o){j(e)||(e=[e]);var i=x(n),a=function(){var a=(o||function(){return y(t,e)})();if(i&&"className"===r){var u=[];M(a)?F(a,function(t,e){t&&u.push(e)}):j(a)&&F(a,function(t){Z(t)?u.push(t):M(t)&&F(t,function(t,e){t&&u.push(e)})}),a=u.join(" ")}else if(i&&"style.cssText"===r){var s=[];M(a)&&F(a,function(t,e){s.push(e+":"+t)}),a=s.join(";")}if(i&&r.startsWith(ot.attrsFlag)){if(null!=a){var c=r.substr(ot.attrsFlag.length);n.setAttribute(c,a)}}else _(n,r,a)},u=function(t,e){var n=E(t),r={};F(n,function(t){var n=V(t,e);r[n]||(r[n]={}),r[n][t]=_(e[n],t)});var o=[];return F(r,function(t,n){o.push({target:e[n],refs:U(t)})}),o}(t,e).map(function(t){return{target:t.target,relations:function(){var e={};return t.refs.forEach(function(t){e[t]={resultIn:a}}),e}()}});return a(),u}function $(e,n,r){if(!x(e)||!M(n))return null;var o=(r=r?j(r)?r:[r]:[]).concat(n),i=e.nodeName.toLowerCase();if(e.nodeType!==Node.ELEMENT_NODE||e[ut.domBoundFlag]){if(e.nodeType===Node.TEXT_NODE){var a=e.nodeValue,u=w(a).join(";");if(""===u)return null;var s=e,c="nodeValue";"textarea"===e.parentNode.nodeName.toLowerCase()&&(s=e.parentNode,c="value"),D(u,o,s,c,function(){return m(a,o)}).forEach(function(t){h(t.target,t.relations)})}}else{if(e[ut.domBoundFlag]=!0,e.hasAttribute(ot.attrPrefix+"each")){var f=ot.attrPrefix+"each",l=A(e.getAttribute(f),n);e.removeAttribute(f);var p=e.parentNode;p.innerHTML="";var d=l.target;function y(t,o){var i=e.cloneNode(!0),a={};return a[l.iterator.val]=t,l.iterator.key&&(a[l.iterator.key]=o),$(i,n,[a].concat(r)),d.on({set:function(t,e,n,r){n==o&&(console.log("set",n,e),a[l.iterator.val]=e)},unshift:function(t){o++,a[l.iterator.key]=o},shift:function(){o>0&&(o--,a[l.iterator.key]=o)},splice:function(t,e,n){if(e)o>=t+e&&(o-=e,a[l.iterator.key]=o);else{var r=Array.prototype.slice.call(arguments,2).length;o>=t&&(o+=r,a[l.iterator.key]=o)}}}),i}return F(d,function(t,e){p.appendChild(y(t,e))}),void d.on({resize:function(){"select"===p.nodeName.toLowerCase()&&p.dispatchEvent(new Event("change"))},push:function(t){p.appendChild(y(t,d.length-1))},unshift:function(t){p.insertBefore(y(t,0),p.childNodes[0])},pop:function(){p.removeChild(p.lastChild)},shift:function(){p.removeChild(p.firstChild)},splice:function(t,e,n){if(e)for(;e>0;e--)p.removeChild(p.childNodes[t]);else{var r=Array.prototype.slice.call(arguments,2);F(r,function(e,n){p.insertBefore(y(e,t+n),p.childNodes[t+n])})}}})}F(e,function(t){$(t,n,r)});var g=[];F(e.attributes,function(a,u){if(u.startsWith(ot.attrPrefix)){g.push(u),u=u.substr(ot.attrPrefix.length).toLowerCase();var s=P(u);if(s)t(e,s,function(t){v(a,[{e:t}].concat(o))},!0);else{if(st[i]&&"value"===u){var c=ot.refBeginsWithDollar?a.substr(1):a,f=G(c,r,n);t(e,st[i],function(t){console.log("input change"),_(f,c,this.value)},!1)}u=it[u]?it[u]:ot.attrsFlag+u,D(a,o,e,u).forEach(function(t){h(t.target,t.relations)})}}}),F(g,function(t){e.removeAttribute(t)})}return e}Object.keys||(Object.keys=function(t){if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}),Object.values||(Object.values=function(t){if(t!==Object(t))throw new TypeError("Object.values called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(t[n]);return e});var b=function(){return 1e4*(new Date).getTime()+Math.floor(1e4*Math.random())},z=function(t){return"number"==typeof t},N=function(t){var e=parseInt(t);return!isNaN(e)&&(("number"==typeof t||"string"==typeof t)&&e==t)},Z=function(t){return"string"==typeof t},O=function(t){return"function"==typeof t},M=function(t){return null!=t&&!(t instanceof Array)&&"[object Object]"===Object.prototype.toString.call(t)},j=function(t){return"[object Array]"===Object.prototype.toString.call(t)},k=function(t){return t instanceof Array},T=function(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t},L=function(t,e){return"function"==typeof e&&t instanceof e},x=function(t){return"function"==typeof Node&&t instanceof Node},C=function(t){return t instanceof NamedNodeMap},P=function(t){return!(!Z(t)||!t.startsWith("on"))&&t.substr(2)},F=function(t,e,n){var r,o;if(!j(t)&&O(t.forEach))t.forEach(e);else if(M(t)){for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}else if(k(t))if(n)for(r=t.length-1;r>=0&&!1!==e(t[r],r);r--);else for(r=0,o=t.length;r<o&&!1!==e(t[r],r);r++);else if(x(t)){var a=!1;switch(t.nodeType){case Node.ELEMENT_NODE:break;case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_TYPE_NODE:case Node.DOCUMENT_FRAGMENT_NODE:default:a=!0}if(a)return;var u=t.childNodes;for(r=0,o=u.length;r<o&&u[r];r++)e(u[r]),F(u[r],e)}else if(C(t))for(r=0,o=t.length;r<o&&!1!==e(t[r].nodeValue,t[r].nodeName);r++);},I=function(t){var e=t;return M(t)?(e={},F(t,function(t,n){e[n]=I(t)})):k(t)&&(e=new t.constructor,F(t,function(t){e.push(I(t))})),e},S=function(t,e){if(M(t))return t.hasOwnProperty(e);if(k(t)){var n=parseInt(e);return N(e)&&t.length>n&&n>=0}return!1},B=function(t,e,n){var r=Z(e)||z(e),o=r?t[e]:t;(M(o)||k(o))&&(F(o,function(t,e){B(o,e)}),k(o)&&R(o)),r&&(t[e]=n)},R=function(t,e){if(z(e))for(F(t,function(n,r){if(!(r>=e))return!1;t.pop()},!0);t.length<e;)t.push(null);else F(t,function(e,n){null==e&&t.pop()},!0);return t},W=function(t,e,n,r){function o(t,e,n){return M(e)||k(e)?k(e)?k(t)?(t.splice.apply(t,[0,t.length].concat(e)),t):I(e):(F(e,function(e,r){!S(t,r)||T(e)?t[r]!==e&&(t[r]=I(e)):t[r]=o(t[r],e,n)}),n&&F(t,function(n,r){S(e,r)||B(t,r)}),t):e}if(!M(t))return e;var i,a=0;n=!1;var u=arguments[arguments.length-1];return O(u)?(a=2,u,n=!!arguments[arguments.length-2]):!0===u&&(a=1,n=u),i=Array.prototype.slice.call(arguments,1,arguments.length-a),F(i,function(e){t=o(t,e,n)}),t},U=function(t){if(k(t))return[];var e=[];return F(t,function(t,n){if(e.push(n),M(t)){var r=U(t);F(r,function(t){e.push(n+"."+t)})}}),e},K=function(t,e){for(var n=t,r=e.split(".");r.length;){var o=r.shift();if(!S(n,o))return!1;n=n[o]}return!0},G=function(t,e){for(var n,r=Array.prototype.slice.call(arguments,1),o=0,i=r.length;o<i;o++)if(n=r[o],j(n)){var a=G.apply(null,[t].concat(n));if(a)return a}else if(K(n,t))return n},V=function(t,e){var n=e.length-1;return F(e,function(e,r){if(K(e,t))return n=r,!1}),n};r.prototype=[],r.prototype.constructor=r,r.prototype.addEventListener=function(t,e){var n=this;M(t)?F(t,function(t,e){n.addEventListener(e,t)}):this["on"+t]&&O(e)&&this["on"+t].push(e)},r.prototype.on=r.prototype.addEventListener,r.prototype.removeEventListener=function(t,e){var n=this;if(M(t))F(t,function(t,e){n.removeEventListener(e,t)});else if(this["on"+t]&&O(e)){var r=this["on"+t];F(r,function(t,n){if(t===e)return r.splice(n,1),!1})}},r.prototype.off=r.prototype.removeEventListener,r.prototype.dispatchEvent=function(t,e){e=Array.prototype.slice.call(arguments,1);var n=this;F(this["on"+t],function(t){t.apply(n,e)})},r.prototype.trigger=r.prototype.dispatchEvent,r.prototype.get=function(t){return this.__data[t]},r.prototype.set=function(t,e){var n=this.__data[t];T(n)||T(e)?(this.dispatchEvent("set",n,e,t,this.__data),this.__data[t]=e):W(n,e,!0)},r.prototype.assignElement=function(t){n(this,t,{get:function(){return this.get(t)},set:function(e){this.set(t,e)},configurable:!0,enumerable:!0})},r.prototype.deleteElement=function(){this.hasOwnProperty(this.length-1)&&delete this[this.length-1]},["push","unshift"].forEach(function(t){r.prototype[t]=function(e){this.__data[t](e),this.assignElement(this.length-1),this.dispatchEvent(t,e),this.dispatchEvent("resize")}}),["pop","shift"].forEach(function(t){r.prototype[t]=function(){this.dispatchEvent(t,this.__data["pop"===t?this.length-1:0]),this.deleteElement(),this.__data[t](),this.dispatchEvent("resize")}}),r.prototype.toArray=function(t){return t?this.__data:I(this.__data)},r.prototype.splice=function(t,e,n){(!z(t)||t<0)&&(t=0),t>=this.length&&(t=this.length),(!z(e)||e<0)&&(e=0),e+t>this.length&&(e=this.length-t);for(var r=[],o=t;o<t+e;o++)r.push(I(this.get(o)));for(var i=Array.prototype.slice.call(arguments,2),a=i.length,u=Math.min(e,a),s=t;s<t+u;s++)this.set(s,i[s-t]);if(e!==a){var c;e>a?(c=[t+a,e-a],Array.prototype.splice.apply(this.__data,c)):(c=[t+e,0].concat(i.slice(e)),Array.prototype.splice.apply(this.__data,c)),this.dispatchEvent.apply(this,["splice"].concat(c)),this.dispatchEvent("resize")}},r.prototype.forEach=function(t){for(var e=0;e<this.length&&!1!==t(this.get(e),e);e++);},["reverse","sort"].forEach(function(t){r.prototype[t]=function(){var e=I(this.__data);Array.prototype[t].apply(e,arguments);for(var n=0;n<this.length;n++)this.set(n,e[n])}}),["slice","concat","filter","map","reduce","indexOf","find","findIndex","fill","join"].forEach(function(t){r.prototype[t]=function(){return Array.prototype[t].apply(this.toArray(),arguments)}}),r.prototype.clear=function(){for(;this.length;)this.pop();return this},r.prototype.cast=function(t){return this.splice.apply(this,[0,this.length].concat(t))};window._DMD_=window._DMD_||{};var H=window._DMD_.Store=window._DMD_.Store||{},X=window._DMD_.Dnstreams=window._DMD_.Dnstreams||{},q=window._DMD_.ResultsIn=window._DMD_.ResultsIn||{},Y=window._DMD_.Upstreams=window._DMD_.Upstreams||{},J=window._DMD_.ResultsFrom=window._DMD_.ResultsFrom||{},Q=window._DMD_.Laziness=window._DMD_.Laziness||{},tt=window._DMD_.PropKernelTable=window._DMD_.PropKernelTable||{},et=window._DMD_.KernelStatus=window._DMD_.KernelStatus||{},nt=window._DMD_.GetterSetter=window._DMD_.GetterSetter||{},rt={};l.prototype.disable=function(){et[this.__kid]=0},l.prototype.enable=function(){et[this.__kid]=1},l.prototype.destroy=function(){};var ot={attrPrefix:"m-",refBeginsWithDollar:!0,attrsFlag:"attrs."},it={value:"value",checked:"checked",innertext:"innerText",innerhtml:"innerHTML",class:"className",style:"style.cssText"},at={each11:/^\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each12:/^\s*\(\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each21:/^\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each22:/^\s*\(\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/},ut={domBoundFlag:"__dmd_bound",domListKey:"__dmd_key"},st={input:"input",select:"change"},ct=function(t,e){Z(t)&&(t=window.document.querySelector(t)),$.call(this,t,e)};return ct.kernel=l,ct.relate=h,ct.$=_,ct});
//# sourceMappingURL=domod.min.js.map
