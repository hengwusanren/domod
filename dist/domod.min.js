!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.domod=e()}(this,function(){"use strict";function t(t,e,n,r){t.addEventListener?t.addEventListener(e,n,!!r):("input"===e&&(e="propertychange"),t.attachEvent("on"+e,n))}function e(t,n,r){n=n||function(){return!0};var o={};return P(t,function(t,i){if(Z(t)&&!n(t)){var a=e(t,n,r);P(a,function(t,e){o[i+"."+e]=t})}else!n(t)&&r||(o[i]=t)}),o}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,n):"value"in n&&(t[e]=n.value)}function r(t,e){Z(t)&&1===arguments.length&&(e=t),M(t)||(t=[]),e||(e={}),n(this,"__data",{value:t}),n(this,"length",{get:function(){return t.length},set:function(e){t.length=e}});var r=this,o=["set","push","pop","unshift","shift","splice","resize"];o.forEach(function(t){n(r,"on"+t,{value:[]})}),o.forEach(function(t){r.addEventListener(t,e["on"+t])}),P(t,function(t,e){r.assignElement(e)})}function o(t,e,n,o){L(t)?"value"in n&&(t[e]=n.value):T(t,r)?n.set&&t.on("set",function(t,r,o,i){o==e&&n.set(r)}):Object.defineProperty(t,e,n),!1!==o&&(o=o||a(e,t),!et[o]&&("get"in n||"set"in n)&&(et[o]={}),"get"in n&&(et[o].get=n.get),"set"in n&&(et[o].set=n.set))}function i(t,e){return e&&""!==e?t&&""!==t?t+"."+e:e:t}function a(t,e){if(void 0===e)return t;var n=u(e);return null==n?t||"":i(n,t)}function u(t){if(t===V||!Z(t)&&!L(t))return null;if(!t.__kernel_root){var e="kr_"+b();o(t,"__kernel_root",{value:e}),V[e]=t}return t.__kernel_root}function s(t,e){return(Z(t)||z(t))&&(t=[t]),M(t)?t.map(function(t){return Z(t)?i(u(t.root),t.alias):z(t)?i(u(e),t):null}):[]}function c(t){return void 0===Q[t]?0:Q[t].length}function f(t,e,n){var a,f={};if(null!=(f=h(e,t))){a=f.target[f.property];var l;f.target.__proppath?l=i(f.target.__proppath,f.property):(o(f.target,"__proppath",{value:i(u(t),e.split(".").slice(0,-1).join("."))}),l=i(u(t),e));var p=l+"#"+c(l);o(this,"__kid",{value:p},!1),tt[this.__kid]=1,void 0===Q[l]&&(Q[l]=[],I(f.target,f.property)&&!T(f.target,r)&&delete f.target[f.property]),Q[l].push(1);var _=s(n.dnstream,t),v=n.resultIn,y=s(n.upstream,t),g=n.resultFrom,E=!!n.lazy;H[l]||(H[l]={}),_.forEach(function(t){q[t]||(q[t]={}),q[t][l]||(q[t][l]={}),q[t][l][p]=1,H[l][t]||(H[l][t]={}),H[l][t][p]=1}),X[l]||(X[l]=[]),X[l].push(O(v)?v:null),q[l]||(q[l]={}),y.forEach(function(t){q[l][t]||(q[l][t]={}),q[l][t][p]=1,H[t]||(H[t]={}),H[t][l]||(H[t][l]={}),H[t][l][p]=1}),O(g)&&(Y[l]={f:g,k:this.__kid,deps:y}),E&&(J[l]=!0),1===Q[l].length&&o(f.target,f.property,{get:function(){if(Y[l]&&0!==tt[Y[l].k]){var t=Y[l].f.apply(null,Y[l].deps.map(function(t){return d(null,t)}));a!==t&&et[l].set(t)}return a},set:function(e,n){(n||e!==a)&&(e!==a&&(!T(f.target,r)||Z(a)&&Z(e)?a=R(a,e):(f.target.set(f.property,e),a=f.target[f.property])),X[l]&&X[l].forEach(function(e,n){e&&0!==tt[l+"#"+n]&&e.apply(t,[a])}),H[l]&&P(H[l],function(t,e){var n=!1;P(t,function(t,e){if(0!==tt[e])return n=!0,!1}),n&&Y[e]&&!J[e]&&d(null,e)}))},enumerable:!0},l),I(n,"value")&&d(null,l,n.value)}}function l(t){if(!Z(t))return!1;var e=!0,n={__isRelation:2,dnstream:1,resultIn:1,upstream:1,resultFrom:1,lazy:!0,value:!0},r=0;return P(t,function(t,o){return 2===n[o]?(e=!0,r++,!1):n[o]?void(1===n[o]&&r++):(e=!1,!1)}),e&&r>0}function p(t,n){var r;if(1===arguments.length){if(!Z(t))return null;r=e(t,l,!0)}else{if(!Z(n))return null;r=e(n,l,!0)}return P(r,function(e,n){new f(t,n,e)}),t}function h(t,e){if(void 0===e&&(e=V),!Z(e)&&!L(e)||!z(t))return null;var n=a(t,e),r=n.lastIndexOf("."),o=n.substring(0,r),i=n.substring(r+1),u=d(null,o,nt,!0);return null==u&&(u=d(null,o,{},!0)),{target:u,property:i}}function d(t,e,n,o){t=t||V;var i=arguments.length>=3&&n!==nt,a=t,u=[];e&&(u=e.split("."));for(var s,c;u.length;){if(o&&null==a)s[c]={};else if(k(a))return;c=u.shift(),i&&0===u.length?!T(a,r)||Z(a[c])&&Z(n)?a[c]=R(a[c],n):a.set(c,n):(s=a,a=a[c])}return i?a[c]:a}function _(t,e,n){rt.refBeginsWithDollar&&(t=t.replace(/(\$[a-zA-Z$_][0-9a-zA-Z$_]*)\s*=[^=]/g,function(t,e){return t.replace(e,"this."+e.substr(1))})),M(e)?n||(n=e[e.length-1]):(e=[e],n||(n=e[0]));var r={};P(e,function(t){P(t,function(t,e){e in r||(r[e]=t)})});var o=Object.keys(r);rt.refBeginsWithDollar&&(o=o.map(function(t){return"$"+t}));var i=Object.values(r);return new Function(o.join(","),"return ("+t+")").apply(n,i)}function v(t,e){t=y(t);var n=null;try{n=_(t,e)}catch(t){}return n}function y(t){var e=/{{([^{}]*)}}/g;return t.replace(e,function(t,e){return"' + ("+e+") + '"})}function g(t,e){var n=/{{([^{}]*)}}/g;return t.replace(n,function(t,n){var r=null;try{r=_(n,e)}catch(t){}return r})}function E(t){t=";"+t+";";var e;return rt.refBeginsWithDollar?(e=/\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*/g,t.match(e).map(function(t){return t.substr(1)})):(e=/([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*/g,t.match(e))}function w(t,e){var n,o,i,a;rt.refBeginsWithDollar?(a=it.each12.exec(t))?(n=a[1].substr(1),o=a[3].substr(1),i=a[5].substr(1)):(n=(a=it.each11.exec(t))[1].substr(1),i=a[3].substr(1)):(a=it.each22.exec(t))?(n=a[1],o=a[3],i=a[5]):(n=(a=it.each21.exec(t))[1],i=a[3]);var u=K(i,e),s=d(u,i);return s instanceof r||d(u,i,s=new r(s)),{target:s,targetRef:i,iterator:{val:n,key:o}}}function m(t){var e=/{{([^{}]*)}}/g,n=[];return t.replace(e,function(t,e){return n.push(e),""}),n}function D(t,e,n,r,o){M(e)||(e=[e]);var i=L(n),a=function(){var a=(o||function(){return v(t,e)})();if(i&&"className"===r){var u=[];Z(a)?P(a,function(t,e){t&&u.push(e)}):M(a)&&P(a,function(t){z(t)?u.push(t):Z(t)&&P(t,function(t,e){t&&u.push(e)})}),a=u.join(" ")}else if(i&&"style.cssText"===r){var s=[];Z(a)&&P(a,function(t,e){s.push(e+":"+t)}),a=s.join(";")}if(i&&r.startsWith(rt.attrsFlag)){if(null!=a){var c=r.substr(rt.attrsFlag.length);n.setAttribute(c,a)}}else d(n,r,a)},u=function(t,e){var n=E(t),r={};P(n,function(t){var n=G(t,e);r[n]||(r[n]={}),r[n][t]=d(e[n],t)});var o=[];return P(r,function(t,n){o.push({target:e[n],refs:W(t)})}),o}(t,e).map(function(t){return{target:t.target,relations:function(){var e={};return t.refs.forEach(function(t){e[t]={resultIn:a}}),e}()}});return a(),u}function A(e,n,r){if(!L(e)||!Z(n))return null;var o=(r=r?M(r)?r:[r]:[]).concat(n),i=e.nodeName.toLowerCase();if(e.nodeType!==Node.ELEMENT_NODE||e[at.domBoundFlag]){if(e.nodeType===Node.TEXT_NODE){var a=e.nodeValue,u=m(a).join(";");if(""===u)return null;var s=e,c="nodeValue";"textarea"===e.parentNode.nodeName.toLowerCase()&&(s=e.parentNode,c="value"),D(u,o,s,c,function(){return g(a,o)}).forEach(function(t){p(t.target,t.relations)})}}else{if(e[at.domBoundFlag]=!0,e.hasAttribute(rt.attrPrefix+"each")){var f=rt.attrPrefix+"each",l=w(e.getAttribute(f),n);e.removeAttribute(f);var h=e.parentNode;h.innerHTML="";var v=l.target;function y(t,o){var i=e.cloneNode(!0),a={};return a[l.iterator.val]=t,l.iterator.key&&(a[l.iterator.key]=o),A(i,n,[a].concat(r)),v.on({set:function(t,e,n,r){n==o&&(console.log("set",n,e),a[l.iterator.val]=e)},unshift:function(t){o++,a[l.iterator.key]=o},shift:function(){o>0&&(o--,a[l.iterator.key]=o)},splice:function(t,e,n){if(e)o>=t+e&&(o-=e,a[l.iterator.key]=o);else{var r=Array.prototype.slice.call(arguments,2).length;o>=t&&(o+=r,a[l.iterator.key]=o)}}}),i}return P(v,function(t,e){h.appendChild(y(t,e))}),void v.on({resize:function(){"select"===h.nodeName.toLowerCase()&&h.dispatchEvent(new Event("change"))},push:function(t){h.appendChild(y(t,v.length-1))},unshift:function(t){h.insertBefore(y(t,0),h.childNodes[0])},pop:function(){h.removeChild(h.lastChild)},shift:function(){h.removeChild(h.firstChild)},splice:function(t,e,n){if(e)for(;e>0;e--)h.removeChild(h.childNodes[t]);else{var r=Array.prototype.slice.call(arguments,2);P(r,function(e,n){h.insertBefore(y(e,t+n),h.childNodes[t+n])})}}})}P(e,function(t){A(t,n,r)});var E=[];P(e.attributes,function(a,u){if(u.startsWith(rt.attrPrefix)){E.push(u),u=u.substr(rt.attrPrefix.length).toLowerCase();var s=C(u);if(s)t(e,s,function(t){_(a,[{e:t}].concat(o))},!0);else{if(ut[i]&&"value"===u){var c=rt.refBeginsWithDollar?a.substr(1):a,f=K(c,r,n);t(e,ut[i],function(t){console.log("input change"),d(f,c,this.value)},!1)}u=ot[u]?ot[u]:rt.attrsFlag+u,D(a,o,e,u).forEach(function(t){p(t.target,t.relations)})}}}),P(E,function(t){e.removeAttribute(t)})}return e}Object.keys||(Object.keys=function(t){if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}),Object.values||(Object.values=function(t){if(t!==Object(t))throw new TypeError("Object.values called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(t[n]);return e});var b=function(){return 1e4*(new Date).getTime()+Math.floor(1e4*Math.random())},$=function(t){return"number"==typeof t},N=function(t){var e=parseInt(t);return!isNaN(e)&&(("number"==typeof t||"string"==typeof t)&&e==t)},z=function(t){return"string"==typeof t},O=function(t){return"function"==typeof t},Z=function(t){return null!=t&&!(t instanceof Array)&&"[object Object]"===Object.prototype.toString.call(t)},M=function(t){return"[object Array]"===Object.prototype.toString.call(t)},j=function(t){return t instanceof Array},k=function(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t},T=function(t,e){return"function"==typeof e&&t instanceof e},L=function(t){return"function"==typeof Node&&t instanceof Node},x=function(t){return t instanceof NamedNodeMap},C=function(t){return!(!z(t)||!t.startsWith("on"))&&t.substr(2)},P=function(t,e,n){var r,o;if(!M(t)&&O(t.forEach))t.forEach(e);else if(Z(t)){for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}else if(j(t))if(n)for(r=t.length-1;r>=0&&!1!==e(t[r],r);r--);else for(r=0,o=t.length;r<o&&!1!==e(t[r],r);r++);else if(L(t)){var a=!1;switch(t.nodeType){case Node.ELEMENT_NODE:break;case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_TYPE_NODE:case Node.DOCUMENT_FRAGMENT_NODE:default:a=!0}if(a)return;var u=t.childNodes;for(r=0,o=u.length;r<o&&u[r];r++)e(u[r]),P(u[r],e)}else if(x(t))for(r=0,o=t.length;r<o&&!1!==e(t[r].nodeValue,t[r].nodeName);r++);},F=function(t){var e=t;return Z(t)?(e={},P(t,function(t,n){e[n]=F(t)})):j(t)&&(e=new t.constructor,P(t,function(t){e.push(F(t))})),e},I=function(t,e){if(Z(t))return t.hasOwnProperty(e);if(j(t)){var n=parseInt(e);return N(e)&&t.length>n&&n>=0}return!1},S=function(t,e,n){var r=z(e)||$(e),o=r?t[e]:t;(Z(o)||j(o))&&(P(o,function(t,e){S(o,e)}),j(o)&&B(o)),r&&(t[e]=n)},B=function(t,e){if($(e))for(P(t,function(n,r){if(!(r>=e))return!1;t.pop()},!0);t.length<e;)t.push(null);else P(t,function(e,n){null==e&&t.pop()},!0);return t},R=function(t,e,n,r){function o(t,e,n){return Z(e)||j(e)?j(e)?j(t)?(t.splice.apply(t,[0,t.length].concat(e)),t):F(e):(P(e,function(e,r){!I(t,r)||k(e)?t[r]!==e&&(t[r]=F(e)):t[r]=o(t[r],e,n)}),n&&P(t,function(n,r){I(e,r)||S(t,r)}),t):e}if(!Z(t))return e;var i,a=0;n=!1;var u=arguments[arguments.length-1];return O(u)?(a=2,u,n=!!arguments[arguments.length-2]):!0===u&&(a=1,n=u),i=Array.prototype.slice.call(arguments,1,arguments.length-a),P(i,function(e){t=o(t,e,n)}),t},W=function(t){if(j(t))return[];var e=[];return P(t,function(t,n){if(e.push(n),Z(t)){var r=W(t);P(r,function(t){e.push(n+"."+t)})}}),e},U=function(t,e){for(var n=t,r=e.split(".");r.length;){var o=r.shift();if(!I(n,o))return!1;n=n[o]}return!0},K=function(t,e){for(var n,r=Array.prototype.slice.call(arguments,1),o=0,i=r.length;o<i;o++)if(n=r[o],M(n)){var a=K.apply(null,[t].concat(n));if(a)return a}else if(U(n,t))return n},G=function(t,e){var n=e.length-1;return P(e,function(e,r){if(U(e,t))return n=r,!1}),n};r.prototype=[],r.prototype.constructor=r,r.prototype.addEventListener=function(t,e){var n=this;Z(t)?P(t,function(t,e){n.addEventListener(e,t)}):this["on"+t]&&O(e)&&this["on"+t].push(e)},r.prototype.on=r.prototype.addEventListener,r.prototype.removeEventListener=function(t,e){var n=this;if(Z(t))P(t,function(t,e){n.removeEventListener(e,t)});else if(this["on"+t]&&O(e)){var r=this["on"+t];P(r,function(t,n){if(t===e)return r.splice(n,1),!1})}},r.prototype.off=r.prototype.removeEventListener,r.prototype.dispatchEvent=function(t,e){e=Array.prototype.slice.call(arguments,1);var n=this;P(this["on"+t],function(t){t.apply(n,e)})},r.prototype.trigger=r.prototype.dispatchEvent,r.prototype.get=function(t){return this.__data[t]},r.prototype.set=function(t,e){var n=this.__data[t];k(n)||k(e)?(this.dispatchEvent("set",n,e,t,this.__data),this.__data[t]=e):R(n,e,!0)},r.prototype.assignElement=function(t){n(this,t,{get:function(){return this.get(t)},set:function(e){this.set(t,e)},configurable:!0,enumerable:!0})},r.prototype.deleteElement=function(){this.hasOwnProperty(this.length-1)&&delete this[this.length-1]},["push","unshift"].forEach(function(t){r.prototype[t]=function(e){this.__data[t](e),this.assignElement(this.length-1),this.dispatchEvent(t,e),this.dispatchEvent("resize")}}),["pop","shift"].forEach(function(t){r.prototype[t]=function(){this.dispatchEvent(t,this.__data["pop"===t?this.length-1:0]),this.deleteElement(),this.__data[t](),this.dispatchEvent("resize")}}),r.prototype.toArray=function(t){return t?this.__data:F(this.__data)},r.prototype.splice=function(t,e,n){(!$(t)||t<0)&&(t=0),t>=this.length&&(t=this.length),(!$(e)||e<0)&&(e=0),e+t>this.length&&(e=this.length-t);for(var r=[],o=t;o<t+e;o++)r.push(F(this.get(o)));for(var i=Array.prototype.slice.call(arguments,2),a=i.length,u=Math.min(e,a),s=t;s<t+u;s++)this.set(s,i[s-t]);if(e!==a){var c;e>a?(c=[t+a,e-a],Array.prototype.splice.apply(this.__data,c)):(c=[t+e,0].concat(i.slice(e)),Array.prototype.splice.apply(this.__data,c)),this.dispatchEvent.apply(this,["splice"].concat(c)),this.dispatchEvent("resize")}},r.prototype.forEach=function(t){for(var e=0;e<this.length&&!1!==t(this.get(e),e);e++);},["reverse","sort"].forEach(function(t){r.prototype[t]=function(){var e=F(this.__data);Array.prototype[t].apply(e,arguments);for(var n=0;n<this.length;n++)this.set(n,e[n])}}),["slice","concat","filter","map","reduce","indexOf","find","findIndex","fill","join"].forEach(function(t){r.prototype[t]=function(){return Array.prototype[t].apply(this.toArray(),arguments)}}),r.prototype.clear=function(){for(;this.length;)this.pop();return this},r.prototype.cast=function(t){return this.splice.apply(this,[0,this.length].concat(t))};window._DMD_=window._DMD_||{};var V=window._DMD_.Store=window._DMD_.Store||{},H=window._DMD_.Dnstreams=window._DMD_.Dnstreams||{},X=window._DMD_.ResultsIn=window._DMD_.ResultsIn||{},q=window._DMD_.Upstreams=window._DMD_.Upstreams||{},Y=window._DMD_.ResultsFrom=window._DMD_.ResultsFrom||{},J=window._DMD_.Laziness=window._DMD_.Laziness||{},Q=window._DMD_.PropKernelTable=window._DMD_.PropKernelTable||{},tt=window._DMD_.KernelStatus=window._DMD_.KernelStatus||{},et=window._DMD_.GetterSetter=window._DMD_.GetterSetter||{},nt={};f.prototype.disable=function(){tt[this.__kid]=0},f.prototype.enable=function(){tt[this.__kid]=1},f.prototype.destroy=function(){};var rt={attrPrefix:"m-",refBeginsWithDollar:!0,attrsFlag:"attrs."},ot={value:"value",checked:"checked",innertext:"innerText",innerhtml:"innerHTML",class:"className",style:"style.cssText"},it={each11:/^\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each12:/^\s*\(\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each21:/^\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each22:/^\s*\(\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/},at={domBoundFlag:"__dmd_bound",domListKey:"__dmd_key"},ut={input:"input",select:"change"},st=function(t,e){z(t)&&(t=window.document.querySelector(t)),A.call(this,t,e)};return st.kernel=f,st.relate=p,st.$=d,st});
//# sourceMappingURL=domod.min.js.map
