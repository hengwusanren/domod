!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.domod=e()}(this,function(){"use strict";function t(t,e,n,r){t.addEventListener?t.addEventListener(e,n,!!r):("input"===e&&(e="propertychange"),t.attachEvent("on"+e,n))}function e(t,n,r){n=n||function(){return!0};var o={};return O(t,function(t,i){if(A(t)&&!n(t)){var a=e(t,n,r);O(a,function(t,e){o[i+"."+e]=t})}else!n(t)&&r||(o[i]=t)}),o}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,n):"value"in n&&(t[e]=n.value)}function r(t,e){A(t)&&1===arguments.length&&(e=t),D(t)||(t=[]),e||(e={}),n(this,"__data",{value:t}),n(this,"length",{get:function(){return t.length},set:function(e){t.length=e}});var r=this,o=["set","push","pop","unshift","shift","splice","resize"];o.forEach(function(t){n(r,"on"+t,{value:[]})}),o.forEach(function(t){r.addEventListener(t,e["on"+t])}),O(t,function(t,e){r.assignElement(e)})}function o(t,e,n,o){N(t)?"value"in n&&(t[e]=n.value):z(t,r)?n.set&&t.on("set",function(t,r,o,i){o==e&&n.set(r)}):Object.defineProperty(t,e,n),!1!==o&&(o=o||u(e,t),!H[o]&&("get"in n||"set"in n)&&(H[o]={}),"get"in n&&(H[o].get=n.get),"set"in n&&(H[o].set=n.set))}function i(t,e){return e&&""!==e?t&&""!==t?t+"."+e:e:t}function a(t){return t.replace(/"([0-9a-zA-Z$_]+)"/gm,function(t,e){return e}).replace(/'([0-9a-zA-Z$_]+)'/gm,function(t,e){return e}).replace(/\[([0-9a-zA-Z$_]+)\]/gm,function(t,e){return"."+e}).split(".")}function u(t,e){if(void 0===e)return t;var n=s(e);return null==n?t||"":i(n,t)}function s(t){if(t===I||!A(t)&&!N(t))return null;if(!t.__kernel_root){var e="kr_"+y();o(t,"__kernel_root",{value:e}),I[e]=t}return t.__kernel_root}function c(t,e){return(A(t)||m(t))&&(t=[t]),D(t)?t.map(function(t){return A(t)?i(s(t.root),t.alias):m(t)?i(s(e),t):null}):[]}function f(t,e,n){"string"==typeof e&&(e=a(e).join("."));var f,l={};if(null!=(l=function(t,e){void 0===e&&(e=I);if(!A(e)&&!N(e)||!m(t))return null;var n=u(t,e),r=n.lastIndexOf("."),o=n.substring(0,r),i=n.substring(r+1),a=h(null,o,V,!0);null==a&&(a=h(null,o,{},!0));return{target:a,property:i}}(e,t))){f=l.target[l.property];var p;l.target.__proppath?p=i(l.target.__proppath,l.property):(o(l.target,"__proppath",{value:i(s(t),a(e).slice(0,-1).join("."))}),p=i(s(t),e));var _=p+"#"+function(t){return void 0===K[t]?0:K[t].length}(p);o(this,"__kid",{value:_},!1),G[this.__kid]=1,void 0===K[p]&&(K[p]=[],j(l.target,l.property)&&!z(l.target,r)&&delete l.target[l.property]),K[p].push(1);var d=c(n.dnstream,t),v=n.resultIn,y=c(n.upstream,t),g=n.resultFrom,D=!!n.lazy;S[p]||(S[p]={}),d.forEach(function(t){R[t]||(R[t]={}),R[t][p]||(R[t][p]={}),R[t][p][_]=1,S[p][t]||(S[p][t]={}),S[p][t][_]=1}),B[p]||(B[p]=[]),B[p].push(E(v)?v:null),R[p]||(R[p]={}),y.forEach(function(t){R[p][t]||(R[p][t]={}),R[p][t][_]=1,S[t]||(S[t]={}),S[t][p]||(S[t][p]={}),S[t][p][_]=1}),E(g)&&(W[p]={f:g,k:this.__kid,deps:y}),D&&(U[p]=!0),1===K[p].length&&o(l.target,l.property,{get:function(){if(W[p]&&0!==G[W[p].k]){var e=W[p].f.apply(t,W[p].deps.map(function(t){return h(null,t)}));f!==e&&H[p].set(e)}return f},set:function(e,n){(n||e!==f)&&(e!==f&&(!z(l.target,r)||A(f)&&A(e)?f=w(f,e):(l.target.set(l.property,e),f=l.target[l.property])),B[p]&&B[p].forEach(function(e,n){e&&0!==G[p+"#"+n]&&e.apply(t,[f])}),S[p]&&O(S[p],function(t,e){var n=!1;O(t,function(t,e){if(0!==G[e])return n=!0,!1}),n&&W[e]&&!U[e]&&h(null,e)}))},enumerable:!0},p),j(n,"value")&&h(null,p,n.value)}}function l(t){if(!A(t))return!1;var e=!0,n={__isRelation:2,dnstream:1,resultIn:1,upstream:1,resultFrom:1,lazy:!0,value:!0},r=0;return O(t,function(t,o){return 2===n[o]?(e=!0,r++,!1):n[o]?void(1===n[o]&&r++):(e=!1,!1)}),e&&r>0}function p(t,n){var r;if(1===arguments.length){if(!A(t))return null;r=e(t,l,!0)}else{if(!A(n))return null;r=e(n,l,!0)}return O(r,function(e,n){new f(t,n,e)}),t}function h(t,e,n,o){t=t||I;var i=arguments.length>=3&&n!==V,u=t,s=[];e&&(s=a(e));for(var c,f;s.length;){if(o&&null==u)c[f]={};else if($(u))return;f=s.shift(),i&&0===s.length?!z(u,r)||A(u[f])&&A(n)?u[f]=w(u[f],n):u.set(f,n):(c=u,u=u[f])}return i?u[f]:u}function _(t,e,n){X.refBeginsWithDollar&&(t=t.replace(/(\$[a-zA-Z$_][0-9a-zA-Z$_]*)\s*=[^=]/g,function(t,e){return t.replace(e,"this."+e.substr(1))})),D(e)?n||(n=e[e.length-1]):(e=[e],n||(n=e[0]));var r={};O(e,function(t){O(t,function(t,e){e in r||(E(t)?r[e]=t.bind(n):r[e]=t)})});var o=Object.keys(r);X.refBeginsWithDollar&&(o=o.map(function(t){return"$"+t}));var i=Object.values(r);return new Function(o.join(","),"return ("+t+")").apply(n,i)}function d(t,e,n,r,o){D(e)||(e=[e]);var i=N(n),a=function(){var a=(o||function(){return function(t,e){t=function(t){return t.replace(/{{([^{}]*)}}/g,function(t,e){return"' + ("+e+") + '"})}(t);var n=null;try{n=_(t,e)}catch(t){}return n}(t,e)})();if(i&&"className"===r){var u=[];A(a)?O(a,function(t,e){t&&u.push(e)}):D(a)&&O(a,function(t){m(t)?u.push(t):A(t)&&O(t,function(t,e){t&&u.push(e)})}),a=u.join(" ")}else if(i&&"style.cssText"===r){var s=[];A(a)&&O(a,function(t,e){s.push(e+":"+t)}),a=s.join(";")}if(i&&r.startsWith(X.attrsFlag)){if(null!=a){var c=r.substr(X.attrsFlag.length);n.setAttribute(c,a)}}else h(n,r,a)},u=function(t,e){var n=function(t){t=";"+t+";";var e,n=function(t){return t.replace(/\.([0-9]+)([^0-9a-zA-Z$_]?)/g,function(t,e,n){return"["+e+"]"+n})};return X.refBeginsWithDollar?(t=t.replace(/([^a-zA-Z0-9$_.])this\./gm,function(t,e){return e+"$"}),e=/\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*/g,(t.match(e)||[]).map(function(t){return t.substr(1)}).map(n)):(t=t.replace(/([^a-zA-Z0-9$_.])this\./gm,function(t,e){return e}),e=/([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*/g,(t.match(e)||[]).map(n))}(t),r={};O(n,function(t){var n=P(t,e);r[n]||(r[n]={}),r[n][t]=h(e[n],t)});var o=[];return O(r,function(t,n){o.push({target:e[n],refs:L(t)})}),o}(t,e).map(function(t){return{target:t.target,relations:function(){var e={};return t.refs.forEach(function(t){e[t]={resultIn:a}}),e}()}});return a(),u}function v(e,n,o){if(!N(e)||!A(n))return null;var i=(o=o?D(o)?o:[o]:[]).concat(n),a=e.nodeName.toLowerCase();if(e.nodeType!==Node.ELEMENT_NODE||e[J.domBoundFlag]){if(e.nodeType===Node.TEXT_NODE){var u=e.nodeValue,s=function(t){var e=[];return t.replace(/{{([^{}]*)}}/g,function(t,n){return e.push(n),""}),e}(u).join(";");if(""===s)return null;var c=e,f="nodeValue";"textarea"===e.parentNode.nodeName.toLowerCase()&&(c=e.parentNode,f="value"),d(s,i,c,f,function(){return function(t,e){return t.replace(/{{([^{}]*)}}/g,function(t,n){var r=null;try{r=_(n,e)}catch(t){}return r})}(u,i)}).forEach(function(t){p(t.target,t.relations)})}}else{if(e[J.domBoundFlag]=!0,e.hasAttribute(X.attrPrefix+"each")){var l=X.attrPrefix+"each",y=function(t,e){var n,o,i,a;X.refBeginsWithDollar?(a=Y.each12.exec(t))?(n=a[1].substr(1),o=a[3].substr(1),i=a[5].substr(1)):(n=(a=Y.each11.exec(t))[1].substr(1),i=a[3].substr(1)):(a=Y.each22.exec(t))?(n=a[1],o=a[3],i=a[5]):(n=(a=Y.each21.exec(t))[1],i=a[3]);var u=C(i,e),s=h(u,i);return s instanceof r||h(u,i,s=new r(s)),{target:s,targetRef:i,iterator:{val:n,key:o}}}(e.getAttribute(l),n);e.removeAttribute(l);var g=e.parentNode;g.innerHTML="";var m=y.target;function E(t,r){var i=e.cloneNode(!0),a={};return a[y.iterator.val]=t,y.iterator.key&&(a[y.iterator.key]=r),v(i,n,[a].concat(o)),m.on({set:function(t,e,n,o){n==r&&(console.log("set",n,e),a[y.iterator.val]=e)},unshift:function(t){r++,a[y.iterator.key]=r},shift:function(){r>0&&(r--,a[y.iterator.key]=r)},splice:function(t,e,n){if(e)r>=t+e&&(r-=e,a[y.iterator.key]=r);else{var o=Array.prototype.slice.call(arguments,2).length;r>=t&&(r+=o,a[y.iterator.key]=r)}}}),i}return O(m,function(t,e){g.appendChild(E(t,e))}),void m.on({resize:function(){"select"===g.nodeName.toLowerCase()&&g.dispatchEvent(new Event("change"))},push:function(t){g.appendChild(E(t,m.length-1))},unshift:function(t){g.insertBefore(E(t,0),g.childNodes[0])},pop:function(){g.removeChild(g.lastChild)},shift:function(){g.removeChild(g.firstChild)},splice:function(t,e,n){if(e)for(;e>0;e--)g.removeChild(g.childNodes[t]);else{var r=Array.prototype.slice.call(arguments,2);O(r,function(e,n){g.insertBefore(E(e,t+n),g.childNodes[t+n])})}}})}O(e,function(t){v(t,n,o)});var b=[];O(e.attributes,function(r,u){if(u.startsWith(X.attrPrefix)){b.push(u),u=u.substr(X.attrPrefix.length).toLowerCase();var s=Z(u);if(s)t(e,s,function(t){_(r,[{e:t}].concat(i))},!0);else{if(Q[a]&&"value"===u){var c=X.refBeginsWithDollar?r.substr(1):r,f=C(c,o,n);t(e,Q[a],function(t){console.log("input change"),h(f,c,this.value)},!1)}u=q[u]?q[u]:X.attrsFlag+u;d(r,i,e,u).forEach(function(t){p(t.target,t.relations)})}}}),O(b,function(t){e.removeAttribute(t)})}return e}Object.keys||(Object.keys=function(t){if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}),Object.values||(Object.values=function(t){if(t!==Object(t))throw new TypeError("Object.values called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(t[n]);return e});var y=function(){return 1e4*(new Date).getTime()+Math.floor(1e4*Math.random())},g=function(t){return"number"==typeof t},m=function(t){return"string"==typeof t},E=function(t){return"function"==typeof t},A=function(t){return null!=t&&!(t instanceof Array)&&"[object Object]"===Object.prototype.toString.call(t)},D=function(t){return"[object Array]"===Object.prototype.toString.call(t)},b=function(t){return t instanceof Array},$=function(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t},z=function(t,e){return"function"==typeof e&&t instanceof e},N=function(t){return"function"==typeof Node&&t instanceof Node},Z=function(t){return!(!m(t)||!t.startsWith("on"))&&t.substr(2)},O=function(t,e,n){var r,o;if(!D(t)&&E(t.forEach))t.forEach(e);else if(A(t)){for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}else if(b(t))if(n)for(r=t.length-1;r>=0&&!1!==e(t[r],r);r--);else for(r=0,o=t.length;r<o&&!1!==e(t[r],r);r++);else if(N(t)){var a=!1;switch(t.nodeType){case Node.ELEMENT_NODE:break;case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_TYPE_NODE:case Node.DOCUMENT_FRAGMENT_NODE:default:a=!0}if(a)return;var u=t.childNodes;for(r=0,o=u.length;r<o&&u[r];r++)e(u[r]),O(u[r],e)}else if(function(t){return t instanceof NamedNodeMap}(t))for(r=0,o=t.length;r<o&&!1!==e(t[r].nodeValue,t[r].nodeName);r++);},M=function(t){var e=t;return A(t)?(e={},O(t,function(t,n){e[n]=M(t)})):b(t)&&(e=new t.constructor,O(t,function(t){e.push(M(t))})),e},j=function(t,e){if(A(t))return t.hasOwnProperty(e);if(b(t)){var n=parseInt(e);return function(t){var e=parseInt(t);return!isNaN(e)&&("number"==typeof t||"string"==typeof t)&&e==t}(e)&&t.length>n&&n>=0}return!1},k=function(t,e,n){var r=m(e)||g(e),o=r?t[e]:t;(A(o)||b(o))&&(O(o,function(t,e){k(o,e)}),b(o)&&T(o)),r&&(t[e]=n)},T=function(t,e){if(g(e))for(O(t,function(n,r){if(!(r>=e))return!1;t.pop()},!0);t.length<e;)t.push(null);else O(t,function(e,n){null==e&&t.pop()},!0);return t},w=function(t,e,n,r){function o(t,e,n){return A(e)||b(e)?b(e)?b(t)?(t.splice.apply(t,[0,t.length].concat(e)),t):M(e):(O(e,function(e,r){!j(t,r)||$(e)?t[r]!==e&&(t[r]=M(e)):t[r]=o(t[r],e,n)}),n&&O(t,function(n,r){j(e,r)||k(t,r)}),t):e}if(!A(t))return e;var i,a=0;n=!1;var u=arguments[arguments.length-1];return E(u)?(a=2,u,n=!!arguments[arguments.length-2]):!0===u&&(a=1,n=u),i=Array.prototype.slice.call(arguments,1,arguments.length-a),O(i,function(e){t=o(t,e,n)}),t},L=function(t){if(b(t))return[];var e=[];return O(t,function(t,n){if(e.push(n),A(t)){var r=L(t);O(r,function(t){e.push(n+"."+t)})}}),e},x=function(t,e){for(var n=t,r=e.split(".");r.length;){var o=r.shift();if(!j(n,o))return!1;n=n[o]}return!0},C=function(t,e){for(var n,r=Array.prototype.slice.call(arguments,1),o=0,i=r.length;o<i;o++)if(n=r[o],D(n)){var a=C.apply(null,[t].concat(n));if(a)return a}else if(x(n,t))return n},P=function(t,e){var n=e.length-1;return O(e,function(e,r){if(x(e,t))return n=r,!1}),n};(r.prototype=[]).constructor=r,r.prototype.addEventListener=function(t,e){var n=this;A(t)?O(t,function(t,e){n.addEventListener(e,t)}):this["on"+t]&&E(e)&&this["on"+t].push(e)},r.prototype.on=r.prototype.addEventListener,r.prototype.removeEventListener=function(t,e){var n=this;if(A(t))O(t,function(t,e){n.removeEventListener(e,t)});else if(this["on"+t]&&E(e)){var r=this["on"+t];O(r,function(t,n){if(t===e)return r.splice(n,1),!1})}},r.prototype.off=r.prototype.removeEventListener,r.prototype.dispatchEvent=function(t,e){e=Array.prototype.slice.call(arguments,1);var n=this;O(this["on"+t],function(t){t.apply(n,e)})},r.prototype.trigger=r.prototype.dispatchEvent,r.prototype.get=function(t){return this.__data[t]},r.prototype.set=function(t,e){var n=this.__data[t];$(n)||$(e)?(this.dispatchEvent("set",n,e,t,this.__data),this.__data[t]=e):w(n,e,!0)},r.prototype.assignElement=function(t){n(this,t,{get:function(){return this.get(t)},set:function(e){this.set(t,e)},configurable:!0,enumerable:!0})},r.prototype.deleteElement=function(){this.hasOwnProperty(this.length-1)&&delete this[this.length-1]},["push","unshift"].forEach(function(t){r.prototype[t]=function(e){this.__data[t](e),this.assignElement(this.length-1),this.dispatchEvent(t,e),this.dispatchEvent("resize")}}),["pop","shift"].forEach(function(t){r.prototype[t]=function(){this.dispatchEvent(t,this.__data["pop"===t?this.length-1:0]),this.deleteElement(),this.__data[t](),this.dispatchEvent("resize")}}),r.prototype.toArray=function(t){return t?this.__data:M(this.__data)},r.prototype.splice=function(t,e,n){(!g(t)||t<0)&&(t=0),t>=this.length&&(t=this.length),(!g(e)||e<0)&&(e=0),e+t>this.length&&(e=this.length-t);for(var r=[],o=t;o<t+e;o++)r.push(M(this.get(o)));for(var i=Array.prototype.slice.call(arguments,2),a=i.length,u=Math.min(e,a),s=t;s<t+u;s++)this.set(s,i[s-t]);if(e!==a){var c;e>a?(c=[t+a,e-a],Array.prototype.splice.apply(this.__data,c)):(c=[t+e,0].concat(i.slice(e)),Array.prototype.splice.apply(this.__data,c)),this.dispatchEvent.apply(this,["splice"].concat(c)),this.dispatchEvent("resize")}},r.prototype.forEach=function(t){for(var e=0;e<this.length;e++){if(!1===t(this.get(e),e))break}},["reverse","sort"].forEach(function(t){r.prototype[t]=function(){var e=M(this.__data);Array.prototype[t].apply(e,arguments);for(var n=0;n<this.length;n++)this.set(n,e[n])}}),["slice","concat","filter","map","reduce","indexOf","find","findIndex","fill","join"].forEach(function(t){r.prototype[t]=function(){return Array.prototype[t].apply(this.toArray(),arguments)}}),r.prototype.clear=function(){for(;this.length;)this.pop();return this},r.prototype.cast=function(t){return this.splice.apply(this,[0,this.length].concat(t))};if("object"!=typeof F)var F={};F._DMD_=F._DMD_||{};var I=F._DMD_.Store=F._DMD_.Store||{},S=F._DMD_.Dnstreams=F._DMD_.Dnstreams||{},B=F._DMD_.ResultsIn=F._DMD_.ResultsIn||{},R=F._DMD_.Upstreams=F._DMD_.Upstreams||{},W=F._DMD_.ResultsFrom=F._DMD_.ResultsFrom||{},U=F._DMD_.Laziness=F._DMD_.Laziness||{},K=F._DMD_.PropKernelTable=F._DMD_.PropKernelTable||{},G=F._DMD_.KernelStatus=F._DMD_.KernelStatus||{},H=F._DMD_.GetterSetter=F._DMD_.GetterSetter||{},V={};f.prototype.disable=function(){G[this.__kid]=0},f.prototype.enable=function(){G[this.__kid]=1},f.prototype.destroy=function(){};var X={attrPrefix:"m-",refBeginsWithDollar:!0,attrsFlag:"attrs."},q={value:"value",checked:"checked",innertext:"innerText",innerhtml:"innerHTML",class:"className",style:"style.cssText"},Y={each11:/^\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each12:/^\s*\(\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each21:/^\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each22:/^\s*\(\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[0-9a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/},J={domBoundFlag:"__dmd_bound",domListKey:"__dmd_key"},Q={input:"input",select:"change"},tt=function(t,e){if(m(t)&&(t=window.document.querySelector(t)),m(e)&&arguments.length>2){var n=e;e=arguments[2];var r=document.createDocumentFragment(),o=document.createElement("div");for(o.innerHTML=n;o.childNodes.length>0;)v.call(this,o.childNodes[0],e),r.appendChild(o.childNodes[0]);t.appendChild(r)}else v.call(this,t,e)};return tt.kernel=f,tt.relate=p,tt.$=h,tt});
//# sourceMappingURL=domod.min.js.map
