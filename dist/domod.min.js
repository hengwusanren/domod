!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.domod=e()}(this,function(){"use strict";function t(t,e,n,r){t.addEventListener?t.addEventListener(e,n,!!r):("input"===e&&(e="propertychange"),t.attachEvent("on"+e,n))}function e(t,n,r){n=n||function(){return!0};var o={};return P(t,function(t,i){if(j(t)&&!n(t)){var a=e(t,n,r);P(a,function(t,e){o[i+"."+e]=t})}else!n(t)&&r||(o[i]=t)}),o}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,n):"value"in n&&(t[e]=n.value)}function r(t,e){j(t)&&1===arguments.length&&(e=t),k(t)||(t=[]),e||(e={}),n(this,"__data",{value:t}),n(this,"length",{get:function(){return t.length},set:function(e){t.length=e}});var r=this,o=["set","push","pop","unshift","shift","splice","resize"];o.forEach(function(t){n(r,"on"+t,{value:[]})}),o.forEach(function(t){r.addEventListener(t,e["on"+t])}),P(t,function(t,e){r.assignElement(e)})}function o(t,e,n,o){D(t)?"value"in n&&(t[e]=n.value):x(t,r)?n.set&&t.on("set",function(t,r,o,i){o==e&&n.set(r)}):Object.defineProperty(t,e,n),o=o||i(e,t),!tt[o]&&("get"in n||"set"in n)&&(tt[o]={}),"get"in n&&(tt[o].get=n.get),"set"in n&&(tt[o].set=n.set)}function i(t,e){if(void 0===e)return t;var n=a(e);return null==n?t||"":n+(t?"."+t:"")}function a(t){if(t===G||!j(t)&&!D(t))return null;if(!t.__kernel_root){var e="kr_"+$();o(t,"__kernel_root",{value:e}),G[e]=t}return t.__kernel_root}function u(t,e){return(j(t)||O(t))&&(t=[t]),k(t)?t.map(function(t){return j(t)?a(t.root)+"."+t.alias:O(t)?a(e)+"."+t:null}):[]}function s(t){return void 0===J[t]?0:J[t].length}function c(t,e,n){var i,c={};if(null!=(c=p(e,t))){i=c.target[c.property];var f=a(t)+"."+e,l=f+"#"+s(f);o(this,"__kid",{value:l}),Q[this.__kid]=1,void 0===J[f]&&(J[f]=[],B(c.target,c.property)&&!x(c.target,r)&&delete c.target[c.property]),J[f].push(1);var v=u(n.dnstream,t),d=n.resultIn,y=u(n.upstream,t),g=n.resultFrom,_=!!n.lazy;H[f]||(H[f]={}),v.forEach(function(t){q[t]||(q[t]={}),q[t][f]||(q[t][f]={}),q[t][f][l]=1,H[f][t]||(H[f][t]={}),H[f][t][l]=1}),X[f]||(X[f]=[]),X[f].push(Z(d)?d:null),q[f]||(q[f]={}),y.forEach(function(t){q[f][t]||(q[f][t]={}),q[f][t][l]=1,H[t]||(H[t]={}),H[t][f]||(H[t][f]={}),H[t][f][l]=1}),Z(g)&&(K[f]={f:g,k:this.__kid,deps:y}),_&&(Y[f]=!0),1===J[f].length&&o(c.target,c.property,{get:function(){if(K[f]&&0!==Q[K[f].k]){var t=K[f].f.apply(null,K[f].deps.map(function(t){return h(null,t)}));i!==t&&tt[f].set(t)}return i},set:function(e,n){(n||e!==i)&&(e!==i&&(!x(c.target,r)||j(i)&&j(e)?i=W(i,e):(c.target.set(c.property,e),i=c.target[c.property])),X[f]&&X[f].forEach(function(e,n){e&&0!==Q[f+"#"+n]&&e.apply(t,[i])}),H[f]&&P(H[f],function(t,e){var n=!1;P(t,function(t,e){if(0!==Q[e])return n=!0,!1}),n&&K[e]&&!Y[e]&&h(null,e)}))},enumerable:!0},f),B(n,"value")&&h(null,f,n.value)}}function f(t){if(!j(t))return!1;var e=!0,n={__isRelation:2,dnstream:1,resultIn:1,upstream:1,resultFrom:1,lazy:!0,value:!0},r=0;return P(t,function(t,o){return 2===n[o]?(e=!0,r++,!1):n[o]?void(1===n[o]&&r++):(e=!1,!1)}),e&&r>0}function l(t,n){var r;if(1===arguments.length){if(!j(t))return null;r=e(t,f,!0)}else{if(!j(n))return null;r=e(n,f,!0)}return P(r,function(e,n){new c(t,n,e)}),t}function p(t,e){if(void 0===e&&(e=G),!j(e)&&!D(e)||!O(t))return null;var n=i(t,e),r=n.lastIndexOf("."),o=n.substring(0,r),a=n.substring(r+1),u=h(null,o,et,!0);return null==u&&(u=h(null,o,{},!0)),{target:u,property:a}}function h(t,e,n,o){t=t||G;var a=arguments.length>=3&&n!==et,u=t,s=i(null,t),c=[];e&&(c=e.split("."));for(var f,l;c.length;){if(o&&null==u)f[l]={};else if(w(u))return;l=c.shift(),s+=(""===s?"":".")+l,a&&0===c.length?!x(u,r)||j(u[l])&&j(n)?u[l]=W(u[l],n):u.set(l,n):(f=u,u=u[l])}return a?u[l]:u}function v(t,e,n){nt.refBeginsWithDollar&&(t=t.replace(/(\$[a-zA-Z$_][0-9a-zA-Z$_]*)\s*=[^=]/g,function(t,e){return t.replace(e,"this."+e.substr(1))})),k(e)?n||(n=e[e.length-1]):(e=[e],n||(n=e[0]));var r={};P(e,function(t){P(t,function(t,e){e in r||(r[e]=t)})});var o=Object.keys(r);nt.refBeginsWithDollar&&(o=o.map(function(t){return"$"+t}));var i=Object.values(r);return new Function(o.join(","),"return ("+t+")").apply(n,i)}function d(t,e){t=y(t);var n=null;try{n=v(t,e)}catch(t){}return n}function y(t){var e=/{{([^{}]*)}}/g;return t.replace(e,function(t,e){return"' + ("+e+") + '"})}function g(t,e){var n=/{{([^{}]*)}}/g;return t.replace(n,function(t,n){var r=null;try{r=v(n,e)}catch(t){}return r})}function _(t){t=";"+t+";";var e;return nt.refBeginsWithDollar?(e=/\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*/g,t.match(e).map(function(t){return t.substr(1)})):(e=/([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*/g,t.match(e))}function E(t,e){var n,o,i,a;nt.refBeginsWithDollar?(a=ot.each12.exec(t))?(n=a[1].substr(1),o=a[3].substr(1),i=a[5].substr(1)):(n=(a=ot.each11.exec(t))[1].substr(1),i=a[3].substr(1)):(a=ot.each22.exec(t))?(n=a[1],o=a[3],i=a[5]):(n=(a=ot.each21.exec(t))[1],i=a[3]);var u=U(i,e),s=h(u,i);return s instanceof r||h(u,i,s=new r(s)),{target:s,targetRef:i,iterator:{val:n,key:o}}}function A(t){var e=/{{([^{}]*)}}/g,n=[];return t.replace(e,function(t,e){return n.push(e),""}),n}function b(t,e,n,r,o){k(e)||(e=[e]);var i=D(n),a=function(){var a=(o||function(){return d(t,e)})();if(i&&"className"===r){var u=[];j(a)?P(a,function(t,e){t&&u.push(e)}):k(a)&&P(a,function(t){O(t)?u.push(t):j(t)&&P(t,function(t,e){t&&u.push(e)})}),a=u.join(" ")}else if(i&&"style.cssText"===r){var s=[];j(a)&&P(a,function(t,e){s.push(e+":"+t)}),a=s.join(";")}if(i&&r.startsWith(nt.attrsFlag)){if(null!=a){var c=r.substr(nt.attrsFlag.length);n.setAttribute(c,a)}}else h(n,r,a)},u=function(t,e){var n=_(t),r={};P(n,function(t){var n=V(t,e);r[n]||(r[n]={}),r[n][t]=h(e[n],t)});var o=[];return P(r,function(t,n){o.push({target:e[n],refs:S(t)})}),o}(t,e).map(function(t){return{target:t.target,relations:function(){var e={};return t.refs.forEach(function(t){e[t]={resultIn:a}}),e}()}});return a(),u}function m(e,n,r){if(!D(e)||!j(n))return null;var o=(r=r?k(r)?r:[r]:[]).concat(n),i=e.nodeName.toLowerCase();if(e.nodeType!==Node.ELEMENT_NODE||e[it.domBoundFlag]){if(e.nodeType===Node.TEXT_NODE){var a=e.nodeValue,u=A(a).join(";");if(""===u)return null;var s=e,c="nodeValue";"textarea"===e.parentNode.nodeName.toLowerCase()&&(s=e.parentNode,c="value"),b(u,o,s,c,function(){return g(a,o)}).forEach(function(t){l(t.target,t.relations)})}}else{if(e[it.domBoundFlag]=!0,e.hasAttribute(nt.attrPrefix+"each")){var f=nt.attrPrefix+"each",p=E(e.getAttribute(f),n);e.removeAttribute(f);var d=e.parentNode;d.innerHTML="";var y=p.target;function _(t,o){var i=e.cloneNode(!0),a={};return a[p.iterator.val]=t,a[p.iterator.key]=o,m(i,n,[a].concat(r)),y.on({set:function(t,e,n,r){n==o&&(console.log("set",n,e),a[p.iterator.val]=e)},unshift:function(t){o++,a[p.iterator.key]=o},shift:function(){o>0&&(o--,a[p.iterator.key]=o)},splice:function(t,e,n){if(e)o>=t+e&&(o-=e,a[p.iterator.key]=o);else{var r=Array.prototype.slice.call(arguments,2).length;o>=t&&(o+=r,a[p.iterator.key]=o)}}}),i}return P(y,function(t,e){d.appendChild(_(t,e))}),void y.on({resize:function(){"select"===d.nodeName.toLowerCase()&&d.dispatchEvent(new Event("change"))},push:function(t){d.appendChild(_(t,y.length-1))},unshift:function(t){d.insertBefore(_(t,0),d.childNodes[0])},pop:function(){d.removeChild(d.lastChild)},shift:function(){d.removeChild(d.firstChild)},splice:function(t,e,n){if(e)for(;e>0;e--)d.removeChild(d.childNodes[t]);else{var r=Array.prototype.slice.call(arguments,2);P(r,function(e,n){d.insertBefore(_(e,t+n),d.childNodes[t+n])})}}})}P(e,function(t){m(t,n,r)});var $=[];P(e.attributes,function(a,u){if(u.startsWith(nt.attrPrefix)){$.push(u),u=u.substr(nt.attrPrefix.length).toLowerCase();var s=C(u);if(s)t(e,s,function(t){v(a,[{e:t}].concat(o))},!0);else{if(at[i]&&"value"===u){var c=nt.refBeginsWithDollar?a.substr(1):a,f=U(c,r,n);t(e,at[i],function(t){console.log("input change"),h(f,c,this.value)},!1)}u=rt[u]?rt[u]:nt.attrsFlag+u,b(a,o,e,u).forEach(function(t){l(t.target,t.relations)})}}}),P($,function(t){e.removeAttribute(t)})}return e}Object.keys||(Object.keys=function(t){if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}),Object.values||(Object.values=function(t){if(t!==Object(t))throw new TypeError("Object.values called on a non-object");var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(t[n]);return e});var $=function(){var t=0;return function(){return t++}}(),N=function(t){return"number"==typeof t},z=function(t){var e=parseInt(t);return!isNaN(e)&&(("number"==typeof t||"string"==typeof t)&&e==t)},O=function(t){return"string"==typeof t},Z=function(t){return"function"==typeof t},j=function(t){return null!=t&&!(t instanceof Array)&&"[object Object]"===Object.prototype.toString.call(t)},k=function(t){return"[object Array]"===Object.prototype.toString.call(t)},T=function(t){return t instanceof Array},w=function(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t},x=function(t,e){return"function"==typeof e&&t instanceof e},D=function(t){return"function"==typeof Node&&t instanceof Node},L=function(t){return t instanceof NamedNodeMap},C=function(t){return!(!O(t)||!t.startsWith("on"))&&t.substr(2)},P=function(t,e,n){var r,o;if(!k(t)&&Z(t.forEach))t.forEach(e);else if(j(t)){for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}else if(T(t))if(n)for(r=t.length-1;r>=0&&!1!==e(t[r],r);r--);else for(r=0,o=t.length;r<o&&!1!==e(t[r],r);r++);else if(D(t)){var a=!1;switch(t.nodeType){case Node.ELEMENT_NODE:break;case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_TYPE_NODE:case Node.DOCUMENT_FRAGMENT_NODE:default:a=!0}if(a)return;var u=t.childNodes;for(r=0,o=u.length;r<o;r++)e(u[r]),P(u[r],e)}else if(L(t))for(r=0,o=t.length;r<o&&!1!==e(t[r].nodeValue,t[r].nodeName);r++);},M=function(t){var e=t;return j(t)?(e={},P(t,function(t,n){e[n]=M(t)})):T(t)&&(e=new t.constructor,P(t,function(t){e.push(M(t))})),e},B=function(t,e){if(j(t))return t.hasOwnProperty(e);if(T(t)){var n=parseInt(e);return z(e)&&t.length>n&&n>=0}return!1},F=function(t,e,n){var r=O(e)||N(e),o=r?t[e]:t;(j(o)||T(o))&&(P(o,function(t,e){F(o,e)}),T(o)&&I(o)),r&&(t[e]=n)},I=function(t,e){if(N(e))for(P(t,function(n,r){if(!(r>=e))return!1;t.pop()},!0);t.length<e;)t.push(null);else P(t,function(e,n){null==e&&t.pop()},!0);return t},W=function(t,e,n,r){function o(t,e,n){return j(e)||T(e)?T(e)?T(t)?(t.splice.apply(t,[0,t.length].concat(e)),t):M(e):(P(e,function(e,r){!B(t,r)||w(e)?t[r]!==e&&(t[r]=M(e)):t[r]=o(t[r],e,n)}),n&&P(t,function(n,r){B(e,r)||F(t,r)}),t):e}if(!j(t))return e;var i,a=0;n=!1;var u=arguments[arguments.length-1];return Z(u)?(a=2,u,n=!!arguments[arguments.length-2]):!0===u&&(a=1,n=u),i=Array.prototype.slice.call(arguments,1,arguments.length-a),P(i,function(e){t=o(t,e,n)}),t},S=function(t){if(T(t))return[];var e=[];return P(t,function(t,n){if(e.push(n),j(t)){var r=S(t);P(r,function(t){e.push(n+"."+t)})}}),e},R=function(t,e){for(var n=t,r=e.split(".");r.length;){var o=r.shift();if(!B(n,o))return!1;n=n[o]}return!0},U=function(t,e){for(var n,r=Array.prototype.slice.call(arguments,1),o=0,i=r.length;o<i;o++)if(n=r[o],k(n)){var a=U.apply(null,[t].concat(n));if(a)return a}else if(R(n,t))return n},V=function(t,e){var n=e.length-1;return P(e,function(e,r){if(R(e,t))return n=r,!1}),n};r.prototype=[],r.prototype.constructor=r,r.prototype.addEventListener=function(t,e){var n=this;j(t)?P(t,function(t,e){n.addEventListener(e,t)}):this["on"+t]&&Z(e)&&this["on"+t].push(e)},r.prototype.on=r.prototype.addEventListener,r.prototype.removeEventListener=function(t,e){var n=this;if(j(t))P(t,function(t,e){n.removeEventListener(e,t)});else if(this["on"+t]&&Z(e)){var r=this["on"+t];P(r,function(t,n){if(t===e)return r.splice(n,1),!1})}},r.prototype.off=r.prototype.removeEventListener,r.prototype.dispatchEvent=function(t,e){e=Array.prototype.slice.call(arguments,1);var n=this;P(this["on"+t],function(t){t.apply(n,e)})},r.prototype.trigger=r.prototype.dispatchEvent,r.prototype.get=function(t){return this.__data[t]},r.prototype.set=function(t,e){var n=this.__data[t];w(n)||w(e)?(this.dispatchEvent("set",n,e,t,this.__data),this.__data[t]=e):W(n,e,!0)},r.prototype.assignElement=function(t){n(this,t,{get:function(){return this.get(t)},set:function(e){this.set(t,e)},configurable:!0,enumerable:!0})},r.prototype.deleteElement=function(){this.hasOwnProperty(this.length-1)&&delete this[this.length-1]},["push","unshift"].forEach(function(t){r.prototype[t]=function(e){this.__data[t](e),this.assignElement(this.length-1),this.dispatchEvent(t,e),this.dispatchEvent("resize")}}),["pop","shift"].forEach(function(t){r.prototype[t]=function(){this.dispatchEvent(t,this.__data["pop"===t?this.length-1:0]),this.deleteElement(),this.__data[t](),this.dispatchEvent("resize")}}),r.prototype.toArray=function(t){return t?this.__data:M(this.__data)},r.prototype.splice=function(t,e,n){(!N(t)||t<0)&&(t=0),t>=this.length&&(t=this.length),(!N(e)||e<0)&&(e=0),e+t>this.length&&(e=this.length-t);for(var r=[],o=t;o<t+e;o++)r.push(M(this.get(o)));for(var i=Array.prototype.slice.call(arguments,2),a=i.length,u=Math.min(e,a),s=t;s<t+u;s++)this.set(s,i[s-t]);if(e!==a){var c;e>a?(c=[t+a,e-a],Array.prototype.splice.apply(this.__data,c)):(c=[t+e,0].concat(i.slice(e)),Array.prototype.splice.apply(this.__data,c)),this.dispatchEvent.apply(this,["splice"].concat(c)),this.dispatchEvent("resize")}},r.prototype.forEach=function(t){for(var e=0;e<this.length&&!1!==t(this.get(e),e);e++);},["reverse","sort"].forEach(function(t){r.prototype[t]=function(){var e=M(this.__data);Array.prototype[t].apply(e,arguments);for(var n=0;n<this.length;n++)this.set(n,e[n])}}),["slice","concat","filter","map","reduce","indexOf","find","findIndex","fill","join"].forEach(function(t){r.prototype[t]=function(){return Array.prototype[t].apply(this.toArray(),arguments)}}),r.prototype.clear=function(){for(;this.length;)this.pop();return this},r.prototype.cast=function(t){return this.splice.apply(this,[0,this.length].concat(t))};var G={},H={},X={},q={},K={},Y={},J={},Q={},tt={},et={};c.prototype.disable=function(){Q[this.__kid]=0},c.prototype.enable=function(){Q[this.__kid]=1},c.prototype.destroy=function(){};var nt={attrPrefix:"m-",refBeginsWithDollar:!0,attrsFlag:"attrs."},rt={value:"value",checked:"checked",innertext:"innerText",innerhtml:"innerHTML",class:"className",style:"style.cssText"},ot={each11:/^\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each12:/^\s*\(\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each21:/^\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each22:/^\s*\(\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/},it={domBoundFlag:"__dmd_bound",domListKey:"__dmd_key"},at={input:"input",select:"change"},ut=function(t,e){O(t)&&(t=window.document.querySelector(t)),m.call(this,t,e)};return ut.kernel=c,ut.relate=l,ut.$=h,ut});
//# sourceMappingURL=domod.min.js.map
