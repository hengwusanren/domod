!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.domod=e()}(this,function(){"use strict";function t(t,e,n,r){t.addEventListener?t.addEventListener(e,n,!!r):("input"===e&&(e="propertychange"),t.attachEvent("on"+e,n))}function e(t,n,r){n=n||function(){return!0};var i={};return P(t,function(t,o){if(k(t)&&!n(t)){var a=e(t,n,r);P(a,function(t,e){i[o+"."+e]=t})}else!n(t)&&r||(i[o]=t)}),i}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,n):"value"in n&&(t[e]=n.value)}function r(t,e){k(t)&&1===arguments.length&&(e=t),T(t)||(t=[]),e||(e={}),n(this,"__data",{value:t}),n(this,"length",{get:function(){return t.length},set:function(e){t.length=e}});var r=this,i=["set","push","pop","unshift","shift","splice","resize"];i.forEach(function(t){n(r,"on"+t,{value:[]})}),i.forEach(function(t){r.addEventListener(t,e["on"+t])}),P(t,function(t,e){r.assignElement(e)})}function i(t,e,n,i){C(t)?("value"in n&&(t[e]=n.value),i=i||o(e,t),!tt[i]&&("get"in n||"set"in n)&&(tt[i]={}),"get"in n&&(tt[i].get=n.get),"set"in n&&(tt[i].set=n.set)):L(t,r)?n.set&&t.on("set",function(t,r,i,o){i==e&&n.set(r)}):Object.defineProperty(t,e,n)}function o(t,e){if(void 0===e)return t;var n=a(e);return null==n?t||"":n+(t?"."+t:"")}function a(t){if(t===G||!k(t)&&!C(t))return null;if(!t.__kernel_root){var e="kr_"+N();i(t,"__kernel_root",{value:e}),G[e]=t}return t.__kernel_root}function u(t,e){return(k(t)||Z(t))&&(t=[t]),T(t)?t.map(function(t){return k(t)?a(t.root)+"."+t.alias:Z(t)?a(e)+"."+t:null}):[]}function s(t){return void 0===J[t]?0:J[t].length}function c(t,e,n){var o,c={};if(null!=(c=p(e,t))){o=c.target[c.property];var f=a(t)+"."+e,l=f+"#"+s(f);i(this,"__kid",{value:l}),Q[this.__kid]=1,void 0===J[f]&&(J[f]=[],B(c.target,c.property)&&!L(c.target,r)&&delete c.target[c.property]),J[f].push(1);var d=u(n.dnstream,t),v=n.resultIn,y=u(n.upstream,t),g=n.resultFrom,_=!!n.lazy;H[f]||(H[f]={}),d.forEach(function(t){q[t]||(q[t]={}),q[t][f]||(q[t][f]={}),q[t][f][l]=1,H[f][t]||(H[f][t]={}),H[f][t][l]=1}),X[f]||(X[f]=[]),X[f].push(O(v)?v:null),q[f]||(q[f]={}),y.forEach(function(t){q[f][t]||(q[f][t]={}),q[f][t][l]=1,H[t]||(H[t]={}),H[t][f]||(H[t][f]={}),H[t][f][l]=1}),O(g)&&(K[f]={f:g,k:this.__kid,deps:y}),_&&(Y[f]=!0),1===J[f].length&&i(c.target,c.property,{get:function(){if(K[f]&&0!==Q[K[f].k]){var t=K[f].f.apply(null,K[f].deps.map(function(t){return h(null,t)}));h(null,f,t),o=t}return o},set:function(e,n){(n||e!==o)&&(e!==o&&(!L(c.target,r)||k(o)&&k(e)?o=W(o,e):(c.target.set(c.property,e),o=c.target[c.property])),X[f]&&X[f].forEach(function(e,n){e&&0!==Q[f+"#"+n]&&e.apply(t,[o])}),H[f]&&P(H[f],function(t,e){var n=!1;P(t,function(t,e){if(0!==Q[e])return n=!0,!1}),n&&K[e]&&!Y[e]&&h(null,e)}))},enumerable:!0},f),B(n,"value")&&h(null,f,n.value)}}function f(t){if(!k(t))return!1;var e=!0,n={__isRelation:2,dnstream:1,resultIn:1,upstream:1,resultFrom:1,lazy:!0,value:!0},r=0;return P(t,function(t,i){return 2===n[i]?(e=!0,r++,!1):n[i]?void(1===n[i]&&r++):(e=!1,!1)}),e&&r>0}function l(t,n){var r;if(1===arguments.length){if(!k(t))return null;r=e(t,f,!0)}else{if(!k(n))return null;r=e(n,f,!0)}return P(r,function(e,n){new c(t,n,e)}),t}function p(t,e){if(void 0===e&&(e=G),!k(e)&&!C(e)||!Z(t))return null;var n=o(t,e),r=n.lastIndexOf(".");return{target:h(null,n.substring(0,r)),property:n.substring(r+1)}}function h(t,e,n){t=t||G;var i=arguments.length>=3,a=t,u=o(null,t),s=[];e&&(s=e.split("."));for(var c;s.length;){if(D(a))return;c=s.shift(),u+=(""===u?"":".")+c,i&&0===s.length?!L(a,r)||k(a[c])&&k(n)?a[c]=W(a[c],n):a.set(c,n):a=a[c]}return i?a[c]:a}function d(t,e,n){et.refBeginsWithDollar&&(t=t.replace(/(\$[a-zA-Z$_][0-9a-zA-Z$_]*)\s*=[^=]/g,function(t,e){return t.replace(e,"this."+e.substr(1))})),T(e)?n||(n=e[e.length-1]):(e=[e],n||(n=e[0]));var r={};P(e,function(t){P(t,function(t,e){e in r||(r[e]=t)})});var i=Object.keys(r);et.refBeginsWithDollar&&(i=i.map(function(t){return"$"+t}));var o=Object.values(r);return new Function(i.join(","),"return ("+t+")").apply(n,o)}function v(t,e){t=y(t);var n=null;try{n=d(t,e)}catch(t){}return n}function y(t){var e=/{{([^{}]*)}}/g;return t.replace(e,function(t,e){return"' + ("+e+") + '"})}function g(t,e){var n=/{{([^{}]*)}}/g;return t.replace(n,function(t,n){var r=null;try{r=d(n,e)}catch(t){}return r})}function _(t){t=";"+t+";";var e;return et.refBeginsWithDollar?(e=/\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*/g,t.match(e).map(function(t){return t.substr(1)})):(e=/([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*/g,t.match(e))}function E(t,e){var n,i,o,a;et.refBeginsWithDollar?(a=rt.each12.exec(t))?(n=a[1].substr(1),i=a[3].substr(1),o=a[5].substr(1)):(n=(a=rt.each11.exec(t))[1].substr(1),o=a[3].substr(1)):(a=rt.each22.exec(t))?(n=a[1],i=a[3],o=a[5]):(n=(a=rt.each21.exec(t))[1],o=a[3]);var u=U(o,e),s=h(u,o);return s instanceof r||h(u,o,s=new r(s)),{target:s,targetRef:o,iterator:{val:n,key:i}}}function A(t){var e=/{{([^{}]*)}}/g,n=[];return t.replace(e,function(t,e){return n.push(e),""}),n}function m(t,e,n,r,i){T(e)||(e=[e]);var o=C(n),a=function(){var a=(i||function(){return v(t,e)})();if(o&&"className"===r){var u=[];k(a)?P(a,function(t,e){t&&u.push(e)}):T(a)&&P(a,function(t){Z(t)?u.push(t):k(t)&&P(t,function(t,e){t&&u.push(e)})}),a=u.join(" ")}else if(o&&"style.cssText"===r){var s=[];k(a)&&P(a,function(t,e){s.push(e+":"+t)}),a=s.join(";")}if(o&&r.startsWith(et.attrsFlag)){if(null!=a){var c=r.substr(et.attrsFlag.length);n.setAttribute(c,a)}}else h(n,r,a)},u=function(t,e){var n=_(t),r={};P(n,function(t){var n=V(t,e);r[n]||(r[n]={}),r[n][t]=h(e[n],t)});var i=[];return P(r,function(t,n){i.push({target:e[n],refs:S(t)})}),i}(t,e).map(function(t){return{target:t.target,relations:function(){var e={};return t.refs.forEach(function(t){e[t]={resultIn:a}}),e}()}});return a(),u}function $(e,n,r){if(!C(e)||!k(n))return null;var i=(r=r?T(r)?r:[r]:[]).concat(n),o=e.nodeName.toLowerCase();if(e.nodeType!==Node.ELEMENT_NODE||e[it.domBoundFlag]){if(e.nodeType===Node.TEXT_NODE){var a=e.nodeValue,u=A(a).join(";");if(""===u)return null;var s=e,c="nodeValue";"textarea"===e.parentNode.nodeName.toLowerCase()&&(s=e.parentNode,c="value"),m(u,i,s,c,function(){return g(a,i)}).forEach(function(t){l(t.target,t.relations)})}}else{if(e[it.domBoundFlag]=!0,e.hasAttribute(et.attrPrefix+"each")){var f=et.attrPrefix+"each",p=E(e.getAttribute(f),n);e.removeAttribute(f);var v=e.parentNode;v.innerHTML="";var y=p.target;function _(t,i){var o=e.cloneNode(!0),a={};return a[p.iterator.val]=t,a[p.iterator.key]=i,$(o,n,[a].concat(r)),y.on({set:function(t,e,n,r){n==i&&(console.log("set",n,e),a[p.iterator.val]=e)},unshift:function(t){i++,a[p.iterator.key]=i},shift:function(){i>0&&(i--,a[p.iterator.key]=i)},splice:function(t,e,n){if(e)i>=t+e&&(i-=e,a[p.iterator.key]=i);else{var r=Array.prototype.slice.call(arguments,2).length;i>=t&&(i+=r,a[p.iterator.key]=i)}}}),o}return P(y,function(t,e){v.appendChild(_(t,e))}),void y.on({resize:function(){"select"===v.nodeName.toLowerCase()&&v.dispatchEvent(new Event("change"))},push:function(t){v.appendChild(_(t,y.length-1))},unshift:function(t){v.insertBefore(_(t,0),v.childNodes[0])},pop:function(){v.removeChild(v.lastChild)},shift:function(){v.removeChild(v.firstChild)},splice:function(t,e,n){if(e)for(;e>0;e--)v.removeChild(v.childNodes[t]);else{var r=Array.prototype.slice.call(arguments,2);P(r,function(e,n){v.insertBefore(_(e,t+n),v.childNodes[t+n])})}}})}P(e,function(t){$(t,n,r)});var N=[];P(e.attributes,function(a,u){if(u.startsWith(et.attrPrefix)){N.push(u),u=u.substr(et.attrPrefix.length).toLowerCase();var s=w(u);if(s)t(e,s,function(t){d(a,[{e:t}].concat(i))},!0);else{if(ot[o]&&"value"===u){var c=et.refBeginsWithDollar?a.substr(1):a,f=U(c,r,n);t(e,ot[o],function(t){console.log("input change"),h(f,c,this.value)},!1)}u=nt[u]?nt[u]:et.attrsFlag+u,m(a,i,e,u).forEach(function(t){l(t.target,t.relations)})}}}),P(N,function(t){e.removeAttribute(t)})}return e}var N=function(){var t=0;return function(){return t++}}(),z=function(t){return"number"==typeof t},b=function(t){var e=parseInt(t);return!isNaN(e)&&(("number"==typeof t||"string"==typeof t)&&e==t)},Z=function(t){return"string"==typeof t},O=function(t){return"function"==typeof t},k=function(t){return null!=t&&!(t instanceof Array)&&"[object Object]"===Object.prototype.toString.call(t)},T=function(t){return"[object Array]"===Object.prototype.toString.call(t)},x=function(t){return t instanceof Array},D=function(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t},L=function(t,e){return"function"==typeof e&&t instanceof e},C=function(t){return"function"==typeof Node&&t instanceof Node},j=function(t){return t instanceof NamedNodeMap},w=function(t){return!(!Z(t)||!t.startsWith("on"))&&t.substr(2)},P=function(t,e,n){var r,i;if(!T(t)&&O(t.forEach))t.forEach(e);else if(k(t)){for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}else if(x(t))if(n)for(r=t.length-1;r>=0&&!1!==e(t[r],r);r--);else for(r=0,i=t.length;r<i&&!1!==e(t[r],r);r++);else if(C(t)){var a=!1;switch(t.nodeType){case Node.ELEMENT_NODE:break;case Node.TEXT_NODE:case Node.COMMENT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_NODE:case Node.DOCUMENT_TYPE_NODE:case Node.DOCUMENT_FRAGMENT_NODE:default:a=!0}if(a)return;var u=t.childNodes;for(r=0,i=u.length;r<i;r++)e(u[r]),P(u[r],e)}else if(j(t))for(r=0,i=t.length;r<i&&!1!==e(t[r].nodeValue,t[r].nodeName);r++);},M=function(t){var e=t;return k(t)?(e={},P(t,function(t,n){e[n]=M(t)})):x(t)&&(e=new t.constructor,P(t,function(t){e.push(M(t))})),e},B=function(t,e){if(k(t))return t.hasOwnProperty(e);if(x(t)){var n=parseInt(e);return b(e)&&t.length>n&&n>=0}return!1},F=function(t,e,n){var r=Z(e)||z(e),i=r?t[e]:t;(k(i)||x(i))&&(P(i,function(t,e){F(i,e)}),x(i)&&I(i)),r&&(t[e]=n)},I=function(t,e){if(z(e))for(P(t,function(n,r){if(!(r>=e))return!1;t.pop()},!0);t.length<e;)t.push(null);else P(t,function(e,n){null==e&&t.pop()},!0);return t},W=function(t,e,n,r){function i(t,e,n){return k(e)||x(e)?x(e)?x(t)?(t.splice.apply(t,[0,t.length].concat(e)),t):M(e):(P(e,function(e,r){!B(t,r)||D(e)?t[r]!==e&&(t[r]=M(e)):t[r]=i(t[r],e,n)}),n&&P(t,function(n,r){B(e,r)||F(t,r)}),t):e}if(!k(t))return e;var o,a=0;n=!1;var u=arguments[arguments.length-1];return O(u)?(a=2,u,n=!!arguments[arguments.length-2]):!0===u&&(a=1,n=u),o=Array.prototype.slice.call(arguments,1,arguments.length-a),P(o,function(e){t=i(t,e,n)}),t},S=function(t){if(x(t))return[];var e=[];return P(t,function(t,n){if(e.push(n),k(t)){var r=S(t);P(r,function(t){e.push(n+"."+t)})}}),e},R=function(t,e){for(var n=t,r=e.split(".");r.length;){var i=r.shift();if(!B(n,i))return!1;n=n[i]}return!0},U=function(t,e){for(var n,r=Array.prototype.slice.call(arguments,1),i=0,o=r.length;i<o;i++)if(n=r[i],T(n)){var a=U.apply(null,[t].concat(n));if(a)return a}else if(R(n,t))return n},V=function(t,e){var n=e.length-1;return P(e,function(e,r){if(R(e,t))return n=r,!1}),n};r.prototype=[],r.prototype.constructor=r,r.prototype.addEventListener=function(t,e){var n=this;k(t)?P(t,function(t,e){n.addEventListener(e,t)}):this["on"+t]&&O(e)&&this["on"+t].push(e)},r.prototype.on=r.prototype.addEventListener,r.prototype.removeEventListener=function(t,e){var n=this;if(k(t))P(t,function(t,e){n.removeEventListener(e,t)});else if(this["on"+t]&&O(e)){var r=this["on"+t];P(r,function(t,n){if(t===e)return r.splice(n,1),!1})}},r.prototype.off=r.prototype.removeEventListener,r.prototype.dispatchEvent=function(t,e){e=Array.prototype.slice.call(arguments,1);var n=this;P(this["on"+t],function(t){t.apply(n,e)})},r.prototype.trigger=r.prototype.dispatchEvent,r.prototype.get=function(t){return this.__data[t]},r.prototype.set=function(t,e){var n=this.__data[t];D(n)||D(e)?(this.dispatchEvent("set",n,e,t,this.__data),this.__data[t]=e):W(n,e,!0)},r.prototype.assignElement=function(t){n(this,t,{get:function(){return this.get(t)},set:function(e){this.set(t,e)},configurable:!0,enumerable:!0})},r.prototype.deleteElement=function(){this.hasOwnProperty(this.length-1)&&delete this[this.length-1]},["push","unshift"].forEach(function(t){r.prototype[t]=function(e){this.__data[t](e),this.assignElement(this.length-1),this.dispatchEvent(t,e),this.dispatchEvent("resize")}}),["pop","shift"].forEach(function(t){r.prototype[t]=function(){this.dispatchEvent(t,this.__data["pop"===t?this.length-1:0]),this.deleteElement(),this.__data[t](),this.dispatchEvent("resize")}}),r.prototype.toArray=function(t){return t?this.__data:M(this.__data)},r.prototype.splice=function(t,e,n){(!z(t)||t<0)&&(t=0),t>=this.length&&(t=this.length),(!z(e)||e<0)&&(e=0),e+t>this.length&&(e=this.length-t);for(var r=[],i=t;i<t+e;i++)r.push(M(this.get(i)));for(var o=Array.prototype.slice.call(arguments,2),a=o.length,u=Math.min(e,a),s=t;s<t+u;s++)this.set(s,o[s-t]);if(e!==a){var c;e>a?(c=[t+a,e-a],Array.prototype.splice.apply(this.__data,c)):(c=[t+e,0].concat(o.slice(e)),Array.prototype.splice.apply(this.__data,c)),this.dispatchEvent.apply(this,["splice"].concat(c)),this.dispatchEvent("resize")}},r.prototype.forEach=function(t){for(var e=0;e<this.length&&!1!==t(this.get(e),e);e++);},["reverse","sort"].forEach(function(t){r.prototype[t]=function(){var e=M(this.__data);Array.prototype[t].apply(e,arguments);for(var n=0;n<this.length;n++)this.set(n,e[n])}}),["slice","concat","filter","map","reduce","indexOf","find","findIndex","fill","join"].forEach(function(t){r.prototype[t]=function(){return Array.prototype[t].apply(this.toArray(),arguments)}}),r.prototype.clear=function(){for(;this.length;)this.pop();return this},r.prototype.cast=function(t){return this.splice.apply(this,[0,this.length].concat(t))};var G={},H={},X={},q={},K={},Y={},J={},Q={},tt={};c.prototype.disable=function(){Q[this.__kid]=0},c.prototype.enable=function(){Q[this.__kid]=1},c.prototype.destroy=function(){};var et={attrPrefix:"m-",refBeginsWithDollar:!0,attrsFlag:"attrs."},nt={value:"value",checked:"checked",innertext:"innerText",innerhtml:"innerHTML",class:"className",style:"style.cssText"},rt={each11:/^\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each12:/^\s*\(\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(\$([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(\$([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each21:/^\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/,each22:/^\s*\(\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*,\s*(([a-zA-Z$_][0-9a-zA-Z$_]*))\s*\)\s+in\s+(([a-zA-Z$_][0-9a-zA-Z$_]*)(\.[a-zA-Z$_][0-9a-zA-Z$_]*)*)\s*$/},it={domBoundFlag:"__dmd_bound",domListKey:"__dmd_key"},ot={input:"input",select:"change"},at=function(t,e){Z(t)&&(t=window.document.querySelector(t)),$.call(this,t,e)};return at.kernel=c,at.relate=l,at.$=h,at});
//# sourceMappingURL=domod.min.js.map
